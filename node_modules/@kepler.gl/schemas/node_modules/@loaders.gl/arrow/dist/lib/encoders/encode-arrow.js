// loaders.gl
// SPDX-License-Identifier: MIT
// Copyright (c) vis.gl contributors
import * as arrow from 'apache-arrow';
import { VECTOR_TYPES } from "../types.js";
/**
 * Encodes set of arrays into the Apache Arrow columnar format
 * https://arrow.apache.org/docs/format/Columnar.html#ipc-file-format
 * @param data - columns data
 * @param options - the writer options
 * @returns - encoded ArrayBuffer
 */
export function encodeArrowSync(data) {
    const vectors = {};
    for (const arrayData of data) {
        const arrayVector = createVector(arrayData.array, arrayData.type);
        vectors[arrayData.name] = arrayVector;
    }
    const table = new arrow.Table(vectors);
    const arrowBuffer = arrow.tableToIPC(table);
    return arrowBuffer;
}
/**
 * Create Arrow arrow.Vector from given data and vector type
 * @param array {import('../types').AnyArrayType} - columns data
 * @param type {number} - the writer options
 * @return a vector of one of vector's types defined in the Apache Arrow library
 */
function createVector(array, type) {
    switch (type) {
        case VECTOR_TYPES.DATE:
            return arrow.vectorFromArray(array);
        case VECTOR_TYPES.FLOAT:
        default:
            return arrow.vectorFromArray(array);
    }
}
