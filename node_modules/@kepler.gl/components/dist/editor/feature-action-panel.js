"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _typeof = require("@babel/runtime/helpers/typeof");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.PureFeatureActionPanelFactory = PureFeatureActionPanelFactory;
exports["default"] = FeatureActionPanelFactory;
var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));
var _react = _interopRequireWildcard(require("react"));
var _reactIntl = require("react-intl");
var _copyToClipboard = _interopRequireDefault(require("copy-to-clipboard"));
var _react2 = require("@floating-ui/react");
var _classnames = _interopRequireDefault(require("classnames"));
var _styledComponents = _interopRequireDefault(require("styled-components"));
var _utils = require("@kepler.gl/utils");
var _actionPanel = _interopRequireWildcard(require("../common/action-panel"));
var _icons = require("../common/icons");
var _templateObject; // SPDX-License-Identifier: MIT
// Copyright contributors to the kepler.gl project
function _getRequireWildcardCache(e) { if ("function" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }
function _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || "object" != _typeof(e) && "function" != typeof e) return { "default": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if ("default" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n["default"] = e, t && t.set(e, n), n; }
var LAYOVER_OFFSET = 4;
var StyledActionsLayer = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  position: absolute;\n  .layer-panel-item-disabled {\n    color: ", ";\n  }\n"])), function (props) {
  return props.theme.textColor;
});
var defaultActionIcons = {
  remove: _icons.Trash,
  layer: _icons.Layers,
  copy: _icons.Copy,
  copied: _icons.Checkmark
};
PureFeatureActionPanelFactory.deps = [];
function PureFeatureActionPanelFactory() {
  var FeatureActionPanel = function FeatureActionPanel(_ref) {
    var className = _ref.className,
      datasets = _ref.datasets,
      selectedFeature = _ref.selectedFeature,
      _ref$position = _ref.position,
      position = _ref$position === void 0 ? null : _ref$position,
      layers = _ref.layers,
      currentFilter = _ref.currentFilter,
      onToggleLayer = _ref.onToggleLayer,
      onDeleteFeature = _ref.onDeleteFeature,
      _ref$actionIcons = _ref.actionIcons,
      actionIcons = _ref$actionIcons === void 0 ? defaultActionIcons : _ref$actionIcons,
      children = _ref.children,
      onClose = _ref.onClose;
    var _useState = (0, _react.useState)(false),
      _useState2 = (0, _slicedToArray2["default"])(_useState, 2),
      copied = _useState2[0],
      setCopied = _useState2[1];
    var _ref2 = currentFilter || {},
      _ref2$layerId = _ref2.layerId,
      layerId = _ref2$layerId === void 0 ? [] : _ref2$layerId;
    var intl = (0, _reactIntl.useIntl)();
    var _useFloating = (0, _react2.useFloating)({
        open: true,
        onOpenChange: function onOpenChange(v) {
          if (!v && onClose) {
            onClose();
          }
        }
      }),
      refs = _useFloating.refs,
      context = _useFloating.context;
    var dismiss = (0, _react2.useDismiss)(context);
    var _useInteractions = (0, _react2.useInteractions)([dismiss]),
      getFloatingProps = _useInteractions.getFloatingProps;
    var copyGeometry = (0, _react.useCallback)(function () {
      if (selectedFeature !== null && selectedFeature !== void 0 && selectedFeature.geometry) (0, _copyToClipboard["default"])(JSON.stringify(selectedFeature.geometry));
      setCopied(true);
    }, [selectedFeature === null || selectedFeature === void 0 ? void 0 : selectedFeature.geometry]);
    if (!position) {
      return null;
    }
    var isFilterLayerDisabled = !(0, _utils.canApplyFeatureFilter)(selectedFeature);
    return /*#__PURE__*/_react["default"].createElement(StyledActionsLayer, (0, _extends2["default"])({
      ref: refs.setFloating
    }, getFloatingProps(), {
      className: (0, _classnames["default"])('feature-action-panel', className),
      style: {
        top: "".concat(position.y + LAYOVER_OFFSET, "px"),
        left: "".concat(position.x + LAYOVER_OFFSET, "px")
      }
    }), /*#__PURE__*/_react["default"].createElement(_actionPanel["default"], null, /*#__PURE__*/_react["default"].createElement(_actionPanel.ActionPanelItem, {
      className: "editor-layers-list",
      label: intl.formatMessage({
        id: 'editor.filterLayer',
        defaultMessage: 'Filter layers'
      }),
      Icon: actionIcons.layer,
      isDisabled: isFilterLayerDisabled,
      tooltipText: isFilterLayerDisabled ? intl.formatMessage({
        id: 'editor.filterLayerDisabled'
      }) : null
    }, layers.length ? layers.map(function (layer, index) {
      return /*#__PURE__*/_react["default"].createElement(_actionPanel.ActionPanelItem, {
        key: index,
        label: layer.config.label
        // @ts-ignore
        ,
        color: datasets[layer.config.dataId].color,
        isSelection: true,
        isActive: layerId.includes(layer.id),
        onClick: function onClick() {
          return onToggleLayer(layer);
        },
        className: "layer-panel-item"
      });
    }) : /*#__PURE__*/_react["default"].createElement(_actionPanel.ActionPanelItem, {
      key: 'no-layers',
      label: intl.formatMessage({
        id: 'editor.noLayersToFilter',
        defaultMessage: 'No layers to filter'
      }),
      isSelection: false,
      isActive: false,
      className: "layer-panel-item-disabled"
    })), /*#__PURE__*/_react["default"].createElement(_actionPanel.ActionPanelItem, {
      label: intl.formatMessage({
        id: 'editor.copyGeometry',
        defaultMessage: 'Copy Geometry'
      }),
      className: "delete-panel-item",
      Icon: copied ? actionIcons.copied : actionIcons.copy,
      onClick: copyGeometry
    }), children, /*#__PURE__*/_react["default"].createElement(_actionPanel.ActionPanelItem, {
      label: intl.formatMessage({
        id: 'tooltip.delete',
        defaultMessage: 'Delete'
      }),
      className: "delete-panel-item",
      Icon: actionIcons.remove,
      onClick: onDeleteFeature
    })));
  };
  FeatureActionPanel.displayName = 'FeatureActionPanel';
  return FeatureActionPanel;
}
FeatureActionPanelFactory.deps = PureFeatureActionPanelFactory.deps;
function FeatureActionPanelFactory() {
  return PureFeatureActionPanelFactory();
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJfcmVhY3RJbnRsIiwiX2NvcHlUb0NsaXBib2FyZCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfcmVhY3QyIiwiX2NsYXNzbmFtZXMiLCJfc3R5bGVkQ29tcG9uZW50cyIsIl91dGlscyIsIl9hY3Rpb25QYW5lbCIsIl9pY29ucyIsIl90ZW1wbGF0ZU9iamVjdCIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsImUiLCJXZWFrTWFwIiwiciIsInQiLCJfX2VzTW9kdWxlIiwiX3R5cGVvZiIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsIkxBWU9WRVJfT0ZGU0VUIiwiU3R5bGVkQWN0aW9uc0xheWVyIiwic3R5bGVkIiwiZGl2IiwiX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbDIiLCJwcm9wcyIsInRoZW1lIiwidGV4dENvbG9yIiwiZGVmYXVsdEFjdGlvbkljb25zIiwicmVtb3ZlIiwiVHJhc2giLCJsYXllciIsIkxheWVycyIsImNvcHkiLCJDb3B5IiwiY29waWVkIiwiQ2hlY2ttYXJrIiwiUHVyZUZlYXR1cmVBY3Rpb25QYW5lbEZhY3RvcnkiLCJkZXBzIiwiRmVhdHVyZUFjdGlvblBhbmVsIiwiX3JlZiIsImNsYXNzTmFtZSIsImRhdGFzZXRzIiwic2VsZWN0ZWRGZWF0dXJlIiwiX3JlZiRwb3NpdGlvbiIsInBvc2l0aW9uIiwibGF5ZXJzIiwiY3VycmVudEZpbHRlciIsIm9uVG9nZ2xlTGF5ZXIiLCJvbkRlbGV0ZUZlYXR1cmUiLCJfcmVmJGFjdGlvbkljb25zIiwiYWN0aW9uSWNvbnMiLCJjaGlsZHJlbiIsIm9uQ2xvc2UiLCJfdXNlU3RhdGUiLCJ1c2VTdGF0ZSIsIl91c2VTdGF0ZTIiLCJfc2xpY2VkVG9BcnJheTIiLCJzZXRDb3BpZWQiLCJfcmVmMiIsIl9yZWYyJGxheWVySWQiLCJsYXllcklkIiwiaW50bCIsInVzZUludGwiLCJfdXNlRmxvYXRpbmciLCJ1c2VGbG9hdGluZyIsIm9wZW4iLCJvbk9wZW5DaGFuZ2UiLCJ2IiwicmVmcyIsImNvbnRleHQiLCJkaXNtaXNzIiwidXNlRGlzbWlzcyIsIl91c2VJbnRlcmFjdGlvbnMiLCJ1c2VJbnRlcmFjdGlvbnMiLCJnZXRGbG9hdGluZ1Byb3BzIiwiY29weUdlb21ldHJ5IiwidXNlQ2FsbGJhY2siLCJnZW9tZXRyeSIsIkpTT04iLCJzdHJpbmdpZnkiLCJpc0ZpbHRlckxheWVyRGlzYWJsZWQiLCJjYW5BcHBseUZlYXR1cmVGaWx0ZXIiLCJjcmVhdGVFbGVtZW50IiwiX2V4dGVuZHMyIiwicmVmIiwic2V0RmxvYXRpbmciLCJjbGFzc25hbWVzIiwic3R5bGUiLCJ0b3AiLCJjb25jYXQiLCJ5IiwibGVmdCIsIngiLCJBY3Rpb25QYW5lbEl0ZW0iLCJsYWJlbCIsImZvcm1hdE1lc3NhZ2UiLCJpZCIsImRlZmF1bHRNZXNzYWdlIiwiSWNvbiIsImlzRGlzYWJsZWQiLCJ0b29sdGlwVGV4dCIsImxlbmd0aCIsIm1hcCIsImluZGV4Iiwia2V5IiwiY29uZmlnIiwiY29sb3IiLCJkYXRhSWQiLCJpc1NlbGVjdGlvbiIsImlzQWN0aXZlIiwiaW5jbHVkZXMiLCJvbkNsaWNrIiwiZGlzcGxheU5hbWUiLCJGZWF0dXJlQWN0aW9uUGFuZWxGYWN0b3J5Il0sInNvdXJjZXMiOlsiLi4vLi4vc3JjL2VkaXRvci9mZWF0dXJlLWFjdGlvbi1wYW5lbC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVFxuLy8gQ29weXJpZ2h0IGNvbnRyaWJ1dG9ycyB0byB0aGUga2VwbGVyLmdsIHByb2plY3RcblxuaW1wb3J0IFJlYWN0LCB7dXNlQ2FsbGJhY2ssIHVzZVN0YXRlLCBDb21wb25lbnRUeXBlfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQge3VzZUludGx9IGZyb20gJ3JlYWN0LWludGwnO1xuaW1wb3J0IGNvcHkgZnJvbSAnY29weS10by1jbGlwYm9hcmQnO1xuaW1wb3J0IHt1c2VEaXNtaXNzLCB1c2VGbG9hdGluZywgdXNlSW50ZXJhY3Rpb25zfSBmcm9tICdAZmxvYXRpbmctdWkvcmVhY3QnO1xuaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ3N0eWxlZC1jb21wb25lbnRzJztcblxuaW1wb3J0IHtMYXllcn0gZnJvbSAnQGtlcGxlci5nbC9sYXllcnMnO1xuaW1wb3J0IHtGaWx0ZXJ9IGZyb20gJ0BrZXBsZXIuZ2wvdHlwZXMnO1xuaW1wb3J0IHtGZWF0dXJlfSBmcm9tICdAbmVidWxhLmdsL2VkaXQtbW9kZXMnO1xuaW1wb3J0IHtEYXRhc2V0c30gZnJvbSAnQGtlcGxlci5nbC90YWJsZSc7XG5pbXBvcnQge2NhbkFwcGx5RmVhdHVyZUZpbHRlcn0gZnJvbSAnQGtlcGxlci5nbC91dGlscyc7XG5cbmltcG9ydCBBY3Rpb25QYW5lbCwge0FjdGlvblBhbmVsSXRlbX0gZnJvbSAnLi4vY29tbW9uL2FjdGlvbi1wYW5lbCc7XG5pbXBvcnQge1RyYXNoLCBMYXllcnMsIENvcHksIENoZWNrbWFya30gZnJvbSAnLi4vY29tbW9uL2ljb25zJztcblxuY29uc3QgTEFZT1ZFUl9PRkZTRVQgPSA0O1xuXG5jb25zdCBTdHlsZWRBY3Rpb25zTGF5ZXIgPSBzdHlsZWQuZGl2YFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIC5sYXllci1wYW5lbC1pdGVtLWRpc2FibGVkIHtcbiAgICBjb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS50ZXh0Q29sb3J9O1xuICB9XG5gO1xuY29uc3QgZGVmYXVsdEFjdGlvbkljb25zID0ge1xuICByZW1vdmU6IFRyYXNoLFxuICBsYXllcjogTGF5ZXJzLFxuICBjb3B5OiBDb3B5LFxuICBjb3BpZWQ6IENoZWNrbWFya1xufTtcblB1cmVGZWF0dXJlQWN0aW9uUGFuZWxGYWN0b3J5LmRlcHMgPSBbXTtcblxuZXhwb3J0IGludGVyZmFjZSBGZWF0dXJlQWN0aW9uUGFuZWxQcm9wcyB7XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbiAgZGF0YXNldHM6IERhdGFzZXRzO1xuICBzZWxlY3RlZEZlYXR1cmU6IEZlYXR1cmUgfCBudWxsO1xuICBwb3NpdGlvbjoge1xuICAgIHg6IG51bWJlcjtcbiAgICB5OiBudW1iZXI7XG4gIH0gfCBudWxsO1xuICBsYXllcnM6IExheWVyW107XG4gIGN1cnJlbnRGaWx0ZXI/OiBGaWx0ZXI7XG4gIG9uVG9nZ2xlTGF5ZXI6IChsYXllcjogTGF5ZXIpID0+IHZvaWQ7XG4gIG9uRGVsZXRlRmVhdHVyZTogKCkgPT4gdm9pZDtcbiAgb25DbG9zZT86ICgpID0+IHZvaWQ7XG4gIGNoaWxkcmVuPzogUmVhY3QuUmVhY3ROb2RlO1xuICBhY3Rpb25JY29ucz86IHtcbiAgICBbaWQ6IHN0cmluZ106IFJlYWN0LkVsZW1lbnRUeXBlO1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gUHVyZUZlYXR1cmVBY3Rpb25QYW5lbEZhY3RvcnkoKTogUmVhY3QuRkM8RmVhdHVyZUFjdGlvblBhbmVsUHJvcHM+IHtcbiAgY29uc3QgRmVhdHVyZUFjdGlvblBhbmVsID0gKHtcbiAgICBjbGFzc05hbWUsXG4gICAgZGF0YXNldHMsXG4gICAgc2VsZWN0ZWRGZWF0dXJlLFxuICAgIHBvc2l0aW9uID0gbnVsbCxcbiAgICBsYXllcnMsXG4gICAgY3VycmVudEZpbHRlcixcbiAgICBvblRvZ2dsZUxheWVyLFxuICAgIG9uRGVsZXRlRmVhdHVyZSxcbiAgICBhY3Rpb25JY29ucyA9IGRlZmF1bHRBY3Rpb25JY29ucyxcbiAgICBjaGlsZHJlbixcbiAgICBvbkNsb3NlXG4gIH06IEZlYXR1cmVBY3Rpb25QYW5lbFByb3BzKSA9PiB7XG4gICAgY29uc3QgW2NvcGllZCwgc2V0Q29waWVkXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCB7bGF5ZXJJZCA9IFtdfSA9IGN1cnJlbnRGaWx0ZXIgfHwge307XG4gICAgY29uc3QgaW50bCA9IHVzZUludGwoKTtcblxuICAgIGNvbnN0IHtyZWZzLCBjb250ZXh0fSA9IHVzZUZsb2F0aW5nKHtcbiAgICAgIG9wZW46IHRydWUsXG4gICAgICBvbk9wZW5DaGFuZ2U6IHYgPT4ge1xuICAgICAgICBpZiAoIXYgJiYgb25DbG9zZSkge1xuICAgICAgICAgIG9uQ2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIGNvbnN0IGRpc21pc3MgPSB1c2VEaXNtaXNzKGNvbnRleHQpO1xuXG4gICAgY29uc3Qge2dldEZsb2F0aW5nUHJvcHN9ID0gdXNlSW50ZXJhY3Rpb25zKFtkaXNtaXNzXSk7XG5cbiAgICBjb25zdCBjb3B5R2VvbWV0cnkgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgICBpZiAoc2VsZWN0ZWRGZWF0dXJlPy5nZW9tZXRyeSkgY29weShKU09OLnN0cmluZ2lmeShzZWxlY3RlZEZlYXR1cmUuZ2VvbWV0cnkpKTtcbiAgICAgIHNldENvcGllZCh0cnVlKTtcbiAgICB9LCBbc2VsZWN0ZWRGZWF0dXJlPy5nZW9tZXRyeV0pO1xuXG4gICAgaWYgKCFwb3NpdGlvbikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgaXNGaWx0ZXJMYXllckRpc2FibGVkID0gIWNhbkFwcGx5RmVhdHVyZUZpbHRlcihzZWxlY3RlZEZlYXR1cmUgYXMgYW55KTtcbiAgICByZXR1cm4gKFxuICAgICAgPFN0eWxlZEFjdGlvbnNMYXllclxuICAgICAgICByZWY9e3JlZnMuc2V0RmxvYXRpbmd9XG4gICAgICAgIHsuLi5nZXRGbG9hdGluZ1Byb3BzKCl9XG4gICAgICAgIGNsYXNzTmFtZT17Y2xhc3NuYW1lcygnZmVhdHVyZS1hY3Rpb24tcGFuZWwnLCBjbGFzc05hbWUpfVxuICAgICAgICBzdHlsZT17e1xuICAgICAgICAgIHRvcDogYCR7cG9zaXRpb24ueSArIExBWU9WRVJfT0ZGU0VUfXB4YCxcbiAgICAgICAgICBsZWZ0OiBgJHtwb3NpdGlvbi54ICsgTEFZT1ZFUl9PRkZTRVR9cHhgXG4gICAgICAgIH19XG4gICAgICA+XG4gICAgICAgIDxBY3Rpb25QYW5lbD5cbiAgICAgICAgICA8QWN0aW9uUGFuZWxJdGVtXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJlZGl0b3ItbGF5ZXJzLWxpc3RcIlxuICAgICAgICAgICAgbGFiZWw9e2ludGwuZm9ybWF0TWVzc2FnZSh7aWQ6ICdlZGl0b3IuZmlsdGVyTGF5ZXInLCBkZWZhdWx0TWVzc2FnZTogJ0ZpbHRlciBsYXllcnMnfSl9XG4gICAgICAgICAgICBJY29uPXthY3Rpb25JY29ucy5sYXllcn1cbiAgICAgICAgICAgIGlzRGlzYWJsZWQ9e2lzRmlsdGVyTGF5ZXJEaXNhYmxlZH1cbiAgICAgICAgICAgIHRvb2x0aXBUZXh0PXtcbiAgICAgICAgICAgICAgaXNGaWx0ZXJMYXllckRpc2FibGVkID8gaW50bC5mb3JtYXRNZXNzYWdlKHtpZDogJ2VkaXRvci5maWx0ZXJMYXllckRpc2FibGVkJ30pIDogbnVsbFxuICAgICAgICAgICAgfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIHtsYXllcnMubGVuZ3RoID8gKFxuICAgICAgICAgICAgICBsYXllcnMubWFwKChsYXllciwgaW5kZXgpID0+IChcbiAgICAgICAgICAgICAgICA8QWN0aW9uUGFuZWxJdGVtXG4gICAgICAgICAgICAgICAgICBrZXk9e2luZGV4fVxuICAgICAgICAgICAgICAgICAgbGFiZWw9e2xheWVyLmNvbmZpZy5sYWJlbH1cbiAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgIGNvbG9yPXtkYXRhc2V0c1tsYXllci5jb25maWcuZGF0YUlkXS5jb2xvcn1cbiAgICAgICAgICAgICAgICAgIGlzU2VsZWN0aW9uPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgaXNBY3RpdmU9e2xheWVySWQuaW5jbHVkZXMobGF5ZXIuaWQpfVxuICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gb25Ub2dnbGVMYXllcihsYXllcil9XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJsYXllci1wYW5lbC1pdGVtXCJcbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICApKVxuICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgPEFjdGlvblBhbmVsSXRlbVxuICAgICAgICAgICAgICAgIGtleT17J25vLWxheWVycyd9XG4gICAgICAgICAgICAgICAgbGFiZWw9e2ludGwuZm9ybWF0TWVzc2FnZSh7XG4gICAgICAgICAgICAgICAgICBpZDogJ2VkaXRvci5ub0xheWVyc1RvRmlsdGVyJyxcbiAgICAgICAgICAgICAgICAgIGRlZmF1bHRNZXNzYWdlOiAnTm8gbGF5ZXJzIHRvIGZpbHRlcidcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICBpc1NlbGVjdGlvbj17ZmFsc2V9XG4gICAgICAgICAgICAgICAgaXNBY3RpdmU9e2ZhbHNlfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImxheWVyLXBhbmVsLWl0ZW0tZGlzYWJsZWRcIlxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L0FjdGlvblBhbmVsSXRlbT5cbiAgICAgICAgICA8QWN0aW9uUGFuZWxJdGVtXG4gICAgICAgICAgICBsYWJlbD17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDogJ2VkaXRvci5jb3B5R2VvbWV0cnknLCBkZWZhdWx0TWVzc2FnZTogJ0NvcHkgR2VvbWV0cnknfSl9XG4gICAgICAgICAgICBjbGFzc05hbWU9XCJkZWxldGUtcGFuZWwtaXRlbVwiXG4gICAgICAgICAgICBJY29uPXtjb3BpZWQgPyBhY3Rpb25JY29ucy5jb3BpZWQgOiBhY3Rpb25JY29ucy5jb3B5fVxuICAgICAgICAgICAgb25DbGljaz17Y29weUdlb21ldHJ5fVxuICAgICAgICAgIC8+XG4gICAgICAgICAge2NoaWxkcmVufVxuICAgICAgICAgIDxBY3Rpb25QYW5lbEl0ZW1cbiAgICAgICAgICAgIGxhYmVsPXtpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiAndG9vbHRpcC5kZWxldGUnLCBkZWZhdWx0TWVzc2FnZTogJ0RlbGV0ZSd9KX1cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImRlbGV0ZS1wYW5lbC1pdGVtXCJcbiAgICAgICAgICAgIEljb249e2FjdGlvbkljb25zLnJlbW92ZX1cbiAgICAgICAgICAgIG9uQ2xpY2s9e29uRGVsZXRlRmVhdHVyZX1cbiAgICAgICAgICAvPlxuICAgICAgICA8L0FjdGlvblBhbmVsPlxuICAgICAgPC9TdHlsZWRBY3Rpb25zTGF5ZXI+XG4gICAgKTtcbiAgfTtcblxuICBGZWF0dXJlQWN0aW9uUGFuZWwuZGlzcGxheU5hbWUgPSAnRmVhdHVyZUFjdGlvblBhbmVsJztcblxuICByZXR1cm4gRmVhdHVyZUFjdGlvblBhbmVsO1xufVxuXG5GZWF0dXJlQWN0aW9uUGFuZWxGYWN0b3J5LmRlcHMgPSBQdXJlRmVhdHVyZUFjdGlvblBhbmVsRmFjdG9yeS5kZXBzO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBGZWF0dXJlQWN0aW9uUGFuZWxGYWN0b3J5KCk6IENvbXBvbmVudFR5cGU8RmVhdHVyZUFjdGlvblBhbmVsUHJvcHM+IHtcbiAgcmV0dXJuIFB1cmVGZWF0dXJlQWN0aW9uUGFuZWxGYWN0b3J5KCk7XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUdBLElBQUFBLE1BQUEsR0FBQUMsdUJBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFVBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLGdCQUFBLEdBQUFDLHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBSSxPQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxXQUFBLEdBQUFGLHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBTSxpQkFBQSxHQUFBSCxzQkFBQSxDQUFBSCxPQUFBO0FB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