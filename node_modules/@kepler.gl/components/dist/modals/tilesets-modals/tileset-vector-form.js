"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _typeof = require("@babel/runtime/helpers/typeof");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;
exports.getDatasetAttributesFromVectorTile = getDatasetAttributesFromVectorTile;
var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));
var _react = _interopRequireWildcard(require("react"));
var _styledComponents = _interopRequireDefault(require("styled-components"));
var _constants = require("@kepler.gl/constants");
var _table = require("@kepler.gl/table");
var _useFetchVectorTileMetadata = _interopRequireDefault(require("../../hooks/use-fetch-vector-tile-metadata"));
var _common = require("../../common");
var _templateObject, _templateObject2; // SPDX-License-Identifier: MIT
// Copyright contributors to the kepler.gl project
function _getRequireWildcardCache(e) { if ("function" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }
function _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || "object" != _typeof(e) && "function" != typeof e) return { "default": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if ("default" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n["default"] = e, t && t.set(e, n), n; }
var TilesetInputContainer = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  display: grid;\n  grid-template-rows: repeat(3, 1fr);\n  row-gap: 18px;\n  font-size: 12px;\n"])));
var TilesetInputDescription = _styledComponents["default"].div(_templateObject2 || (_templateObject2 = (0, _taggedTemplateLiteral2["default"])(["\n  text-align: center;\n  color: ", ";\n  font-size: 11px;\n"])), function (props) {
  return props.theme.AZURE200;
});
var isPMTilesUrl = function isPMTilesUrl(url) {
  return url === null || url === void 0 ? void 0 : url.includes('.pmtiles');
};
function getDatasetAttributesFromVectorTile(_ref) {
  var name = _ref.name,
    dataUrl = _ref.dataUrl,
    metadataUrl = _ref.metadataUrl;
  return {
    name: name,
    type: _constants.DatasetType.VECTOR_TILE,
    metadata: {
      type: _constants.REMOTE_TILE,
      remoteTileFormat: isPMTilesUrl(dataUrl) ? _constants.RemoteTileFormat.PMTILES : _constants.RemoteTileFormat.MVT,
      tilesetDataUrl: dataUrl,
      tilesetMetadataUrl: metadataUrl
    }
  };
}
var TilesetVectorForm = function TilesetVectorForm(_ref2) {
  var setResponse = _ref2.setResponse;
  var _useState = (0, _react.useState)(''),
    _useState2 = (0, _slicedToArray2["default"])(_useState, 2),
    tileName = _useState2[0],
    setTileName = _useState2[1];
  var _useState3 = (0, _react.useState)(''),
    _useState4 = (0, _slicedToArray2["default"])(_useState3, 2),
    tileUrl = _useState4[0],
    setTileUrl = _useState4[1];
  var _useState5 = (0, _react.useState)(''),
    _useState6 = (0, _slicedToArray2["default"])(_useState5, 2),
    metadataUrl = _useState6[0],
    setMetadataUrl = _useState6[1];
  var _useState7 = (0, _react.useState)(null),
    _useState8 = (0, _slicedToArray2["default"])(_useState7, 2),
    initialFetchError = _useState8[0],
    setInitialFetchError = _useState8[1];
  var onTileNameChange = (0, _react.useCallback)(function (event) {
    event.preventDefault();
    setTileName(event.target.value);
  }, [setTileName]);
  var onTileMetaUrlChange = (0, _react.useCallback)(function (event) {
    event.preventDefault();
    setMetadataUrl(event.target.value);
  }, [setMetadataUrl]);
  var onTileUrlChange = (0, _react.useCallback)( /*#__PURE__*/function () {
    var _ref3 = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee(event) {
      var newTileUrl, usePMTiles, potentialMetadataUrl, resp;
      return _regenerator["default"].wrap(function _callee$(_context) {
        while (1) switch (_context.prev = _context.next) {
          case 0:
            event.preventDefault();
            newTileUrl = event.target.value;
            setTileUrl(newTileUrl);
            usePMTiles = isPMTilesUrl(newTileUrl);
            potentialMetadataUrl = usePMTiles ? newTileUrl : (0, _table.getMetaUrl)(newTileUrl);
            if (!(!metadataUrl && potentialMetadataUrl)) {
              _context.next = 17;
              break;
            }
            if (!usePMTiles) {
              _context.next = 10;
              break;
            }
            _context.t0 = {
              ok: true
            };
            _context.next = 13;
            break;
          case 10:
            _context.next = 12;
            return fetch(potentialMetadataUrl);
          case 12:
            _context.t0 = _context.sent;
          case 13:
            resp = _context.t0;
            if (resp.ok) {
              setInitialFetchError(null);
              setMetadataUrl(potentialMetadataUrl);
            } else {
              setInitialFetchError(new Error("Metadata loading failed: ".concat(resp.status, " ").concat(resp.statusText)));
            }
            _context.next = 18;
            break;
          case 17:
            setInitialFetchError(null);
          case 18:
            if (!tileName) {
              setTileName(newTileUrl.split('/').pop() || newTileUrl);
            }
          case 19:
          case "end":
            return _context.stop();
        }
      }, _callee);
    }));
    return function (_x) {
      return _ref3.apply(this, arguments);
    };
  }(), [setTileUrl, tileName, setMetadataUrl, metadataUrl]);
  var process = (0, _react.useMemo)(function () {
    return function (value) {
      return (0, _table.parseVectorMetadata)(value, {
        tileUrl: metadataUrl
      });
    };
  }, [metadataUrl]);
  var _useFetchVectorTileMe = (0, _useFetchVectorTileMetadata["default"])({
      metadataUrl: metadataUrl,
      tilesetUrl: tileUrl,
      remoteTileFormat: isPMTilesUrl(metadataUrl) ? _constants.RemoteTileFormat.PMTILES : _constants.RemoteTileFormat.MVT,
      process: process
    }),
    metadata = _useFetchVectorTileMe.data,
    loading = _useFetchVectorTileMe.loading,
    metaError = _useFetchVectorTileMe.error;

  // reset initial fetch error if the metadata is available
  if (metadata && initialFetchError) {
    setInitialFetchError(null);
  }
  (0, _react.useEffect)(function () {
    if (tileName && tileUrl) {
      var dataset = getDatasetAttributesFromVectorTile({
        name: tileName,
        dataUrl: tileUrl,
        metadataUrl: metadataUrl !== null && metadataUrl !== void 0 ? metadataUrl : undefined
      });
      setResponse({
        metadata: metadata,
        dataset: dataset,
        loading: loading,
        error: metaError || initialFetchError
      });
    } else {
      setResponse({
        metadata: metadata,
        dataset: null,
        loading: loading,
        error: metaError || initialFetchError
      });
    }
  }, [setResponse, metadata, loading, metaError, initialFetchError, tileUrl, tileName, metadataUrl]);
  (0, _react.useEffect)(function () {
    if (metadata) {
      setTileName(metadata.name || '');
    }
  }, [metadata]);
  return /*#__PURE__*/_react["default"].createElement(TilesetInputContainer, null, /*#__PURE__*/_react["default"].createElement("div", null, /*#__PURE__*/_react["default"].createElement("label", {
    htmlFor: "tileset-name"
  }, "Name"), /*#__PURE__*/_react["default"].createElement(_common.InputLight, {
    id: "tile-name",
    placeholder: "Name your tileset",
    value: tileName,
    onChange: onTileNameChange
  })), /*#__PURE__*/_react["default"].createElement("div", null, /*#__PURE__*/_react["default"].createElement("label", {
    htmlFor: "tile-url"
  }, "Tileset URL"), /*#__PURE__*/_react["default"].createElement(_common.InputLight, {
    id: "tile-url",
    placeholder: "Tileset URL",
    value: tileUrl,
    onChange: onTileUrlChange
  }), /*#__PURE__*/_react["default"].createElement(TilesetInputDescription, null, "Requires {x}, {y}, {z} placeholders in URL or .pmtile extension.")), /*#__PURE__*/_react["default"].createElement("div", null, /*#__PURE__*/_react["default"].createElement("label", {
    htmlFor: "tile-metadata"
  }, "Tileset metadata URL"), /*#__PURE__*/_react["default"].createElement(_common.InputLight, {
    id: "tile-metadata",
    placeholder: "Tileset metadata",
    value: metadataUrl !== null && metadataUrl !== void 0 ? metadataUrl : undefined,
    onChange: onTileMetaUrlChange
  }), /*#__PURE__*/_react["default"].createElement(TilesetInputDescription, null, "Optional, but recommended. Supports json, txt")));
};
var _default = exports["default"] = TilesetVectorForm;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJfc3R5bGVkQ29tcG9uZW50cyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfY29uc3RhbnRzIiwiX3RhYmxlIiwiX3VzZUZldGNoVmVjdG9yVGlsZU1ldGFkYXRhIiwiX2NvbW1vbiIsIl90ZW1wbGF0ZU9iamVjdCIsIl90ZW1wbGF0ZU9iamVjdDIiLCJfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUiLCJlIiwiV2Vha01hcCIsInIiLCJ0IiwiX19lc01vZHVsZSIsIl90eXBlb2YiLCJoYXMiLCJnZXQiLCJuIiwiX19wcm90b19fIiwiYSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwidSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImkiLCJzZXQiLCJUaWxlc2V0SW5wdXRDb250YWluZXIiLCJzdHlsZWQiLCJkaXYiLCJfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsMiIsIlRpbGVzZXRJbnB1dERlc2NyaXB0aW9uIiwicHJvcHMiLCJ0aGVtZSIsIkFaVVJFMjAwIiwiaXNQTVRpbGVzVXJsIiwidXJsIiwiaW5jbHVkZXMiLCJnZXREYXRhc2V0QXR0cmlidXRlc0Zyb21WZWN0b3JUaWxlIiwiX3JlZiIsIm5hbWUiLCJkYXRhVXJsIiwibWV0YWRhdGFVcmwiLCJ0eXBlIiwiRGF0YXNldFR5cGUiLCJWRUNUT1JfVElMRSIsIm1ldGFkYXRhIiwiUkVNT1RFX1RJTEUiLCJyZW1vdGVUaWxlRm9ybWF0IiwiUmVtb3RlVGlsZUZvcm1hdCIsIlBNVElMRVMiLCJNVlQiLCJ0aWxlc2V0RGF0YVVybCIsInRpbGVzZXRNZXRhZGF0YVVybCIsIlRpbGVzZXRWZWN0b3JGb3JtIiwiX3JlZjIiLCJzZXRSZXNwb25zZSIsIl91c2VTdGF0ZSIsInVzZVN0YXRlIiwiX3VzZVN0YXRlMiIsIl9zbGljZWRUb0FycmF5MiIsInRpbGVOYW1lIiwic2V0VGlsZU5hbWUiLCJfdXNlU3RhdGUzIiwiX3VzZVN0YXRlNCIsInRpbGVVcmwiLCJzZXRUaWxlVXJsIiwiX3VzZVN0YXRlNSIsIl91c2VTdGF0ZTYiLCJzZXRNZXRhZGF0YVVybCIsIl91c2VTdGF0ZTciLCJfdXNlU3RhdGU4IiwiaW5pdGlhbEZldGNoRXJyb3IiLCJzZXRJbml0aWFsRmV0Y2hFcnJvciIsIm9uVGlsZU5hbWVDaGFuZ2UiLCJ1c2VDYWxsYmFjayIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJ2YWx1ZSIsIm9uVGlsZU1ldGFVcmxDaGFuZ2UiLCJvblRpbGVVcmxDaGFuZ2UiLCJfcmVmMyIsIl9hc3luY1RvR2VuZXJhdG9yMiIsIl9yZWdlbmVyYXRvciIsIm1hcmsiLCJfY2FsbGVlIiwibmV3VGlsZVVybCIsInVzZVBNVGlsZXMiLCJwb3RlbnRpYWxNZXRhZGF0YVVybCIsInJlc3AiLCJ3cmFwIiwiX2NhbGxlZSQiLCJfY29udGV4dCIsInByZXYiLCJuZXh0IiwiZ2V0TWV0YVVybCIsInQwIiwib2siLCJmZXRjaCIsInNlbnQiLCJFcnJvciIsImNvbmNhdCIsInN0YXR1cyIsInN0YXR1c1RleHQiLCJzcGxpdCIsInBvcCIsInN0b3AiLCJfeCIsImFwcGx5IiwiYXJndW1lbnRzIiwicHJvY2VzcyIsInVzZU1lbW8iLCJwYXJzZVZlY3Rvck1ldGFkYXRhIiwiX3VzZUZldGNoVmVjdG9yVGlsZU1lIiwidXNlRmV0Y2hWZWN0b3JUaWxlTWV0YWRhdGEiLCJ0aWxlc2V0VXJsIiwiZGF0YSIsImxvYWRpbmciLCJtZXRhRXJyb3IiLCJlcnJvciIsInVzZUVmZmVjdCIsImRhdGFzZXQiLCJ1bmRlZmluZWQiLCJjcmVhdGVFbGVtZW50IiwiaHRtbEZvciIsIklucHV0TGlnaHQiLCJpZCIsInBsYWNlaG9sZGVyIiwib25DaGFuZ2UiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvbW9kYWxzL3RpbGVzZXRzLW1vZGFscy90aWxlc2V0LXZlY3Rvci1mb3JtLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUXG4vLyBDb3B5cmlnaHQgY29udHJpYnV0b3JzIHRvIHRoZSBrZXBsZXIuZ2wgcHJvamVjdFxuXG5pbXBvcnQgUmVhY3QsIHt1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VTdGF0ZSwgdXNlTWVtb30gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHN0eWxlZCBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7XG5cbmltcG9ydCB7XG4gIERhdGFzZXRUeXBlLFxuICBSZW1vdGVUaWxlRm9ybWF0LFxuICBWZWN0b3JUaWxlRGF0YXNldE1ldGFkYXRhLFxuICBSRU1PVEVfVElMRVxufSBmcm9tICdAa2VwbGVyLmdsL2NvbnN0YW50cyc7XG5pbXBvcnQge1RpbGVKU09OfSBmcm9tICdAbG9hZGVycy5nbC9tdnQnO1xuaW1wb3J0IHtQTVRpbGVzTWV0YWRhdGF9IGZyb20gJ0Bsb2FkZXJzLmdsL3BtdGlsZXMnO1xuaW1wb3J0IHtnZXRNZXRhVXJsLCBwYXJzZVZlY3Rvck1ldGFkYXRhLCBWZWN0b3JUaWxlTWV0YWRhdGF9IGZyb20gJ0BrZXBsZXIuZ2wvdGFibGUnO1xuaW1wb3J0IHtNZXJnZX0gZnJvbSAnQGtlcGxlci5nbC90eXBlcyc7XG5cbmltcG9ydCB7ZGVmYXVsdCBhcyB1c2VGZXRjaFZlY3RvclRpbGVNZXRhZGF0YX0gZnJvbSAnLi4vLi4vaG9va3MvdXNlLWZldGNoLXZlY3Rvci10aWxlLW1ldGFkYXRhJztcbmltcG9ydCB7RGF0YXNldENyZWF0aW9uQXR0cmlidXRlcywgTWV0YVJlc3BvbnNlfSBmcm9tICcuL2NvbW1vbic7XG5pbXBvcnQge0lucHV0TGlnaHR9IGZyb20gJy4uLy4uL2NvbW1vbic7XG5cbmNvbnN0IFRpbGVzZXRJbnB1dENvbnRhaW5lciA9IHN0eWxlZC5kaXZgXG4gIGRpc3BsYXk6IGdyaWQ7XG4gIGdyaWQtdGVtcGxhdGUtcm93czogcmVwZWF0KDMsIDFmcik7XG4gIHJvdy1nYXA6IDE4cHg7XG4gIGZvbnQtc2l6ZTogMTJweDtcbmA7XG5cbmNvbnN0IFRpbGVzZXRJbnB1dERlc2NyaXB0aW9uID0gc3R5bGVkLmRpdmBcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBjb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5BWlVSRTIwMH07XG4gIGZvbnQtc2l6ZTogMTFweDtcbmA7XG5cbmV4cG9ydCB0eXBlIFZlY3RvclRpbGVzZXRGb3JtRGF0YSA9IHtcbiAgbmFtZTogc3RyaW5nO1xuICBkYXRhVXJsOiBzdHJpbmc7XG4gIG1ldGFkYXRhVXJsPzogc3RyaW5nO1xufTtcblxuY29uc3QgaXNQTVRpbGVzVXJsID0gKHVybD86IHN0cmluZyB8IG51bGwpID0+IHVybD8uaW5jbHVkZXMoJy5wbXRpbGVzJyk7XG5cbmV4cG9ydCB0eXBlIFZlY3RvclRpbGVEYXRhc2V0Q3JlYXRpb25BdHRyaWJ1dGVzID0gTWVyZ2U8XG4gIERhdGFzZXRDcmVhdGlvbkF0dHJpYnV0ZXMsXG4gIHtcbiAgICBtZXRhZGF0YTogVmVjdG9yVGlsZURhdGFzZXRNZXRhZGF0YTtcbiAgfVxuPjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldERhdGFzZXRBdHRyaWJ1dGVzRnJvbVZlY3RvclRpbGUoe1xuICBuYW1lLFxuICBkYXRhVXJsLFxuICBtZXRhZGF0YVVybFxufTogVmVjdG9yVGlsZXNldEZvcm1EYXRhKTogVmVjdG9yVGlsZURhdGFzZXRDcmVhdGlvbkF0dHJpYnV0ZXMge1xuICByZXR1cm4ge1xuICAgIG5hbWUsXG4gICAgdHlwZTogRGF0YXNldFR5cGUuVkVDVE9SX1RJTEUsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIHR5cGU6IFJFTU9URV9USUxFLFxuICAgICAgcmVtb3RlVGlsZUZvcm1hdDogaXNQTVRpbGVzVXJsKGRhdGFVcmwpID8gUmVtb3RlVGlsZUZvcm1hdC5QTVRJTEVTIDogUmVtb3RlVGlsZUZvcm1hdC5NVlQsXG4gICAgICB0aWxlc2V0RGF0YVVybDogZGF0YVVybCxcbiAgICAgIHRpbGVzZXRNZXRhZGF0YVVybDogbWV0YWRhdGFVcmxcbiAgICB9XG4gIH07XG59XG5cbnR5cGUgVGlsZXNldFZlY3RvckZvcm1Qcm9wcyA9IHtcbiAgc2V0UmVzcG9uc2U6IChyZXNwb25zZTogTWV0YVJlc3BvbnNlKSA9PiB2b2lkO1xufTtcblxuY29uc3QgVGlsZXNldFZlY3RvckZvcm06IFJlYWN0LkZDPFRpbGVzZXRWZWN0b3JGb3JtUHJvcHM+ID0gKHtzZXRSZXNwb25zZX0pID0+IHtcbiAgY29uc3QgW3RpbGVOYW1lLCBzZXRUaWxlTmFtZV0gPSB1c2VTdGF0ZTxzdHJpbmc+KCcnKTtcbiAgY29uc3QgW3RpbGVVcmwsIHNldFRpbGVVcmxdID0gdXNlU3RhdGU8c3RyaW5nPignJyk7XG4gIGNvbnN0IFttZXRhZGF0YVVybCwgc2V0TWV0YWRhdGFVcmxdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4oJycpO1xuICBjb25zdCBbaW5pdGlhbEZldGNoRXJyb3IsIHNldEluaXRpYWxGZXRjaEVycm9yXSA9IHVzZVN0YXRlPEVycm9yIHwgbnVsbD4obnVsbCk7XG5cbiAgY29uc3Qgb25UaWxlTmFtZUNoYW5nZSA9IHVzZUNhbGxiYWNrKFxuICAgIChldmVudDogUmVhY3QuQ2hhbmdlRXZlbnQ8SFRNTElucHV0RWxlbWVudD4pID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBzZXRUaWxlTmFtZShldmVudC50YXJnZXQudmFsdWUpO1xuICAgIH0sXG4gICAgW3NldFRpbGVOYW1lXVxuICApO1xuXG4gIGNvbnN0IG9uVGlsZU1ldGFVcmxDaGFuZ2UgPSB1c2VDYWxsYmFjayhcbiAgICAoZXZlbnQ6IFJlYWN0LkNoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgc2V0TWV0YWRhdGFVcmwoZXZlbnQudGFyZ2V0LnZhbHVlKTtcbiAgICB9LFxuICAgIFtzZXRNZXRhZGF0YVVybF1cbiAgKTtcblxuICBjb25zdCBvblRpbGVVcmxDaGFuZ2UgPSB1c2VDYWxsYmFjayhcbiAgICBhc3luYyAoZXZlbnQ6IFJlYWN0LkNoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgY29uc3QgbmV3VGlsZVVybCA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgICAgIHNldFRpbGVVcmwobmV3VGlsZVVybCk7XG5cbiAgICAgIGNvbnN0IHVzZVBNVGlsZXMgPSBpc1BNVGlsZXNVcmwobmV3VGlsZVVybCk7XG4gICAgICBjb25zdCBwb3RlbnRpYWxNZXRhZGF0YVVybCA9IHVzZVBNVGlsZXMgPyBuZXdUaWxlVXJsIDogZ2V0TWV0YVVybChuZXdUaWxlVXJsKTtcbiAgICAgIGlmICghbWV0YWRhdGFVcmwgJiYgcG90ZW50aWFsTWV0YWRhdGFVcmwpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgVVJMIGV4aXN0cyBiZWZvcmUgc2V0dGluZyBpdCBhcyB0aGUgbWV0YWRhdGEgVVJMXG4gICAgICAgIC8vIE5vdGU6IFRoZSB7bWV0aG9kOiBIRUFEfSByZXF1ZXN0IG9mdGVuIGZhaWxzLCBsaWtlbHkgZHVlIHRvIGluZGl2aWR1YWwgc3RvcmFnZSBzZXR0aW5ncy5cbiAgICAgICAgY29uc3QgcmVzcCA9IHVzZVBNVGlsZXMgPyAoe29rOiB0cnVlfSBhcyBSZXNwb25zZSkgOiBhd2FpdCBmZXRjaChwb3RlbnRpYWxNZXRhZGF0YVVybCk7XG4gICAgICAgIGlmIChyZXNwLm9rKSB7XG4gICAgICAgICAgc2V0SW5pdGlhbEZldGNoRXJyb3IobnVsbCk7XG4gICAgICAgICAgc2V0TWV0YWRhdGFVcmwocG90ZW50aWFsTWV0YWRhdGFVcmwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNldEluaXRpYWxGZXRjaEVycm9yKFxuICAgICAgICAgICAgbmV3IEVycm9yKGBNZXRhZGF0YSBsb2FkaW5nIGZhaWxlZDogJHtyZXNwLnN0YXR1c30gJHtyZXNwLnN0YXR1c1RleHR9YClcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXRJbml0aWFsRmV0Y2hFcnJvcihudWxsKTtcbiAgICAgIH1cbiAgICAgIGlmICghdGlsZU5hbWUpIHtcbiAgICAgICAgc2V0VGlsZU5hbWUobmV3VGlsZVVybC5zcGxpdCgnLycpLnBvcCgpIHx8IG5ld1RpbGVVcmwpO1xuICAgICAgfVxuICAgIH0sXG4gICAgW3NldFRpbGVVcmwsIHRpbGVOYW1lLCBzZXRNZXRhZGF0YVVybCwgbWV0YWRhdGFVcmxdXG4gICk7XG5cbiAgY29uc3QgcHJvY2VzcyA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIHJldHVybiAodmFsdWU6IFBNVGlsZXNNZXRhZGF0YSB8IFRpbGVKU09OKSA9PlxuICAgICAgcGFyc2VWZWN0b3JNZXRhZGF0YSh2YWx1ZSwge3RpbGVVcmw6IG1ldGFkYXRhVXJsfSk7XG4gIH0sIFttZXRhZGF0YVVybF0pO1xuXG4gIGNvbnN0IHtcbiAgICBkYXRhOiBtZXRhZGF0YSxcbiAgICBsb2FkaW5nLFxuICAgIGVycm9yOiBtZXRhRXJyb3JcbiAgfSA9IHVzZUZldGNoVmVjdG9yVGlsZU1ldGFkYXRhKHtcbiAgICBtZXRhZGF0YVVybCxcbiAgICB0aWxlc2V0VXJsOiB0aWxlVXJsLFxuICAgIHJlbW90ZVRpbGVGb3JtYXQ6IGlzUE1UaWxlc1VybChtZXRhZGF0YVVybCkgPyBSZW1vdGVUaWxlRm9ybWF0LlBNVElMRVMgOiBSZW1vdGVUaWxlRm9ybWF0Lk1WVCxcbiAgICBwcm9jZXNzXG4gIH0pO1xuXG4gIC8vIHJlc2V0IGluaXRpYWwgZmV0Y2ggZXJyb3IgaWYgdGhlIG1ldGFkYXRhIGlzIGF2YWlsYWJsZVxuICBpZiAobWV0YWRhdGEgJiYgaW5pdGlhbEZldGNoRXJyb3IpIHtcbiAgICBzZXRJbml0aWFsRmV0Y2hFcnJvcihudWxsKTtcbiAgfVxuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHRpbGVOYW1lICYmIHRpbGVVcmwpIHtcbiAgICAgIGNvbnN0IGRhdGFzZXQgPSBnZXREYXRhc2V0QXR0cmlidXRlc0Zyb21WZWN0b3JUaWxlKHtcbiAgICAgICAgbmFtZTogdGlsZU5hbWUsXG4gICAgICAgIGRhdGFVcmw6IHRpbGVVcmwsXG4gICAgICAgIG1ldGFkYXRhVXJsOiBtZXRhZGF0YVVybCA/PyB1bmRlZmluZWRcbiAgICAgIH0pO1xuICAgICAgc2V0UmVzcG9uc2Uoe1xuICAgICAgICBtZXRhZGF0YSxcbiAgICAgICAgZGF0YXNldCxcbiAgICAgICAgbG9hZGluZyxcbiAgICAgICAgZXJyb3I6IG1ldGFFcnJvciB8fCBpbml0aWFsRmV0Y2hFcnJvclxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNldFJlc3BvbnNlKHtcbiAgICAgICAgbWV0YWRhdGEsXG4gICAgICAgIGRhdGFzZXQ6IG51bGwsXG4gICAgICAgIGxvYWRpbmcsXG4gICAgICAgIGVycm9yOiBtZXRhRXJyb3IgfHwgaW5pdGlhbEZldGNoRXJyb3JcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwgW1xuICAgIHNldFJlc3BvbnNlLFxuICAgIG1ldGFkYXRhLFxuICAgIGxvYWRpbmcsXG4gICAgbWV0YUVycm9yLFxuICAgIGluaXRpYWxGZXRjaEVycm9yLFxuICAgIHRpbGVVcmwsXG4gICAgdGlsZU5hbWUsXG4gICAgbWV0YWRhdGFVcmxcbiAgXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAobWV0YWRhdGEpIHtcbiAgICAgIHNldFRpbGVOYW1lKChtZXRhZGF0YSBhcyBWZWN0b3JUaWxlTWV0YWRhdGEpLm5hbWUgfHwgJycpO1xuICAgIH1cbiAgfSwgW21ldGFkYXRhXSk7XG5cbiAgcmV0dXJuIChcbiAgICA8VGlsZXNldElucHV0Q29udGFpbmVyPlxuICAgICAgPGRpdj5cbiAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJ0aWxlc2V0LW5hbWVcIj5OYW1lPC9sYWJlbD5cbiAgICAgICAgPElucHV0TGlnaHRcbiAgICAgICAgICBpZD1cInRpbGUtbmFtZVwiXG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJOYW1lIHlvdXIgdGlsZXNldFwiXG4gICAgICAgICAgdmFsdWU9e3RpbGVOYW1lfVxuICAgICAgICAgIG9uQ2hhbmdlPXtvblRpbGVOYW1lQ2hhbmdlfVxuICAgICAgICAvPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2PlxuICAgICAgICA8bGFiZWwgaHRtbEZvcj1cInRpbGUtdXJsXCI+VGlsZXNldCBVUkw8L2xhYmVsPlxuICAgICAgICA8SW5wdXRMaWdodFxuICAgICAgICAgIGlkPVwidGlsZS11cmxcIlxuICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVGlsZXNldCBVUkxcIlxuICAgICAgICAgIHZhbHVlPXt0aWxlVXJsfVxuICAgICAgICAgIG9uQ2hhbmdlPXtvblRpbGVVcmxDaGFuZ2V9XG4gICAgICAgIC8+XG4gICAgICAgIDxUaWxlc2V0SW5wdXREZXNjcmlwdGlvbj5cbiAgICAgICAgICBSZXF1aXJlcyAmIzEyMzt4JiMxMjU7LCAmIzEyMzt5JiMxMjU7LCAmIzEyMzt6JiMxMjU7IHBsYWNlaG9sZGVycyBpbiBVUkwgb3IgLnBtdGlsZVxuICAgICAgICAgIGV4dGVuc2lvbi5cbiAgICAgICAgPC9UaWxlc2V0SW5wdXREZXNjcmlwdGlvbj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdj5cbiAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJ0aWxlLW1ldGFkYXRhXCI+VGlsZXNldCBtZXRhZGF0YSBVUkw8L2xhYmVsPlxuICAgICAgICA8SW5wdXRMaWdodFxuICAgICAgICAgIGlkPVwidGlsZS1tZXRhZGF0YVwiXG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJUaWxlc2V0IG1ldGFkYXRhXCJcbiAgICAgICAgICB2YWx1ZT17bWV0YWRhdGFVcmwgPz8gdW5kZWZpbmVkfVxuICAgICAgICAgIG9uQ2hhbmdlPXtvblRpbGVNZXRhVXJsQ2hhbmdlfVxuICAgICAgICAvPlxuICAgICAgICA8VGlsZXNldElucHV0RGVzY3JpcHRpb24+XG4gICAgICAgICAgT3B0aW9uYWwsIGJ1dCByZWNvbW1lbmRlZC4gU3VwcG9ydHMganNvbiwgdHh0XG4gICAgICAgIDwvVGlsZXNldElucHV0RGVzY3JpcHRpb24+XG4gICAgICA8L2Rpdj5cbiAgICA8L1RpbGVzZXRJbnB1dENvbnRhaW5lcj5cbiAgKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IFRpbGVzZXRWZWN0b3JGb3JtO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBR0EsSUFBQUEsTUFBQSxHQUFBQyx1QkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsaUJBQUEsR0FBQUMsc0JBQUEsQ0FBQUYsT0FBQTtBQUVBLElBQUFHLFVBQUEsR0FBQUgsT0FBQTtBQVFBLElBQUFJLE1BQUEsR0FBQUosT0FBQTtBQUdBLElBQUFLLDJCQUFBLEdBQUFILHNCQUFBLENBQUFGLE9BQUE7QUFFQSxJQUFBTSxPQUFBLEdBQUFOLE9BQUE7QUFBd0MsSUFBQU8sZUFBQSxFQUFBQyxnQkFBQSxFQW5CeEM7QUFDQTtBQUFBLFNBQUFDLHlCQUFBQyxDQUFBLDZCQUFBQyxPQUFBLG1CQUFBQyxDQUFBLE9BQUFELE9BQUEsSUFBQUUsQ0FBQSxPQUFBRixPQUFBLFlBQUFGLHdCQUFBLFlBQUFBLHlCQUFBQyxDQUFBLFdBQUFBLENBQUEsR0FBQUcsQ0FBQSxHQUFBRCxDQUFBLEtBQUFGLENBQUE7QUFBQSxTQUFBWCx3QkFBQVcsQ0FBQSxFQUFBRSxDQUFBLFNBQUFBLENBQUEsSUFBQUYsQ0FBQSxJQUFBQSxDQUFBLENBQUFJLFVBQUEsU0FBQUosQ0FBQSxlQUFBQSxDQUFBLGdCQUFBSyxPQUFBLENBQUFMLENBQUEsMEJBQUFBLENBQUEsc0JBQUFBLENBQUEsUUFBQUcsQ0FBQSxHQUFBSix3QkFBQSxDQUFBRyxDQUFBLE9BQUFDLENBQUEsSUFBQUEsQ0FBQSxDQUFBRyxHQUFBLENBQUFOLENBQUEsVUFBQUcsQ0FBQSxDQUFBSSxHQUFBLENBQUFQLENBQUEsT0FBQVEsQ0FBQSxLQUFBQyxTQUFBLFVBQUFDLENBQUEsR0FB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