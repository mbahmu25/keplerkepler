"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.wmsTileVisConfigs = exports["default"] = void 0;
var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));
var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));
var _get2 = _interopRequireDefault(require("@babel/runtime/helpers/get"));
var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));
var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
var _commonUtils = require("@kepler.gl/common-utils");
var _constants = require("@kepler.gl/constants");
var _deckglLayers = require("@kepler.gl/deckgl-layers");
var _tileDataset = _interopRequireDefault(require("../vector-tile/common-tile/tile-dataset"));
var _wmsLayerIcon = _interopRequireDefault(require("./wms-layer-icon"));
var _abstractTileLayer = _interopRequireDefault(require("../vector-tile/abstract-tile-layer"));
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2["default"])(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
function _callSuper(t, o, e) { return o = (0, _getPrototypeOf2["default"])(o), (0, _possibleConstructorReturn2["default"])(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], (0, _getPrototypeOf2["default"])(t).constructor) : o.apply(t, e)); }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function _superPropGet(t, e, r, o) { var p = (0, _get2["default"])((0, _getPrototypeOf2["default"])(1 & o ? t.prototype : t), e, r); return 2 & o ? function (t) { return p.apply(r, t); } : p; } // SPDX-License-Identifier: MIT
// Copyright contributors to the kepler.gl project
// Types

var wmsTileVisConfigs = exports.wmsTileVisConfigs = {
  opacity: 'opacity',
  transparent: 'transparent'
};

// Extend visConfigSettings to satisfy AbstractTileLayer

// Extend LayerData for WMS
// Class Definition
var WMSLayer = exports["default"] = /*#__PURE__*/function (_AbstractTileLayer) {
  // Constructor
  function WMSLayer(props) {
    var _props$layers$, _props$layers;
    var _this;
    (0, _classCallCheck2["default"])(this, WMSLayer);
    _this = _callSuper(this, WMSLayer, [props]);
    // Store reference to the deck layer for feature info access
    (0, _defineProperty2["default"])(_this, "deckLayerRef", null);
    var defaultWmsLayer = (_props$layers$ = (_props$layers = props.layers) === null || _props$layers === void 0 ? void 0 : _props$layers[0]) !== null && _props$layers$ !== void 0 ? _props$layers$ : null;
    _this.registerVisConfig(wmsTileVisConfigs);
    _this.updateLayerVisConfig({
      opacity: 0.8,
      // Default opacity
      wmsLayer: defaultWmsLayer,
      transparent: true
    });
    return _this;
  }

  // Properties
  (0, _inherits2["default"])(WMSLayer, _AbstractTileLayer);
  return (0, _createClass2["default"])(WMSLayer, [{
    key: "type",
    get: function get() {
      return _constants.LAYER_TYPES.wms;
    }
  }, {
    key: "name",
    get: function get() {
      return 'WMS Tile';
    }
  }, {
    key: "layerIcon",
    get: function get() {
      return _wmsLayerIcon["default"];
    }

    // Static Methods
  }, {
    key: "supportedDatasetTypes",
    get:
    // Instance Methods
    function get() {
      return [_constants.DatasetType.WMS_TILE];
    }
  }, {
    key: "initTileDataset",
    value: function initTileDataset() {
      // Provide dummy accessors for raster/WMS
      return new _tileDataset["default"]({
        getTileId: function getTileId(tile) {
          return (tile === null || tile === void 0 ? void 0 : tile.id) || 'wms';
        },
        getIterable: function getIterable(_tile) {
          return [];
        },
        getRowCount: function getRowCount() {
          return 0;
        },
        getRowValue: function getRowValue() {
          return function () {
            return null;
          };
        }
      });
    }
  }, {
    key: "accessRowValue",
    value: function accessRowValue(_field, _indexKey) {
      // WMS layers are raster, so no row access; return a dummy accessor
      return function () {
        return null;
      };
    }
  }, {
    key: "formatLayerData",
    value: function formatLayerData(datasets, oldLayerData, animationConfig) {
      var dataId = this.config.dataId;
      if (!(0, _commonUtils.notNullorUndefined)(dataId) || !datasets[dataId]) {
        return {
          tilesetDataUrl: null,
          metadata: null
        };
      }
      var dataset = datasets[dataId];
      var metadata = dataset === null || dataset === void 0 ? void 0 : dataset.metadata;
      return _objectSpread(_objectSpread({}, _superPropGet(WMSLayer, "formatLayerData", this, 3)([datasets, oldLayerData, animationConfig])), {}, {
        tilesetDataUrl: (metadata === null || metadata === void 0 ? void 0 : metadata.tilesetDataUrl) || null,
        // URL for WMS tiles
        metadata: dataset === null || dataset === void 0 ? void 0 : dataset.metadata
      });
    }
  }, {
    key: "_getCurrentServiceLayer",
    value: function _getCurrentServiceLayer() {
      var _visConfig$wmsLayer;
      var visConfig = this.config.visConfig;
      return (_visConfig$wmsLayer = visConfig.wmsLayer) !== null && _visConfig$wmsLayer !== void 0 ? _visConfig$wmsLayer : null;
    }
  }, {
    key: "updateLayerMeta",
    value: function updateLayerMeta(dataset) {
      if (dataset.type !== _constants.DatasetType.WMS_TILE) {
        return;
      }
      var currentLayer = this._getCurrentServiceLayer();
      if (currentLayer && currentLayer.boundingBox) {
        this.updateMeta({
          bounds: currentLayer.boundingBox
        });
      }
    }
  }, {
    key: "hasHoveredObject",
    value: function hasHoveredObject(objectInfo) {
      // For WMS layers, we consider it hovered if the layer is picked
      // The actual feature info will be retrieved via getHoverData
      if (this.isLayerHovered(objectInfo)) {
        return _objectSpread({
          index: 0
        }, objectInfo);
      }
      return null;
    }
  }, {
    key: "getHoverData",
    value: function getHoverData(object, dataContainer, fields, animationConfig, hoverInfo) {
      // Check if this is a WMS feature info object from clicked state
      if (object !== null && object !== void 0 && object.wmsFeatureInfo) {
        if (Array.isArray(object.wmsFeatureInfo)) {
          return {
            wmsFeatureData: object.wmsFeatureInfo
          };
        }
        return {
          wmsFeatureData: [{
            name: 'WMS Feature Info',
            value: object.wmsFeatureInfo
          }]
        };
      }
      if (hoverInfo.x !== undefined && hoverInfo.y !== undefined) {
        return {
          fieldValues: [{
            labelMessage: 'layer.wms.hover',
            value: 'Click to query WMS feature info'
          }]
        };
      }
      return null;
    }
  }, {
    key: "renderLayer",
    value: function renderLayer(opts) {
      var _interactionConfig$to;
      var visConfig = this.config.visConfig;
      var data = opts.data,
        interactionConfig = opts.interactionConfig,
        layerCallbacks = opts.layerCallbacks;
      var wmsLayer = this._getCurrentServiceLayer();
      if (!wmsLayer) {
        return [];
      }
      var wmsLayerName = wmsLayer.name,
        queryable = wmsLayer.queryable;
      var defaultLayerProps = this.getDefaultDeckLayerProps(opts);
      var pickable = (interactionConfig === null || interactionConfig === void 0 || (_interactionConfig$to = interactionConfig.tooltip) === null || _interactionConfig$to === void 0 ? void 0 : _interactionConfig$to.enabled) && queryable;
      var deckLayer = new _deckglLayers.WMSLayer({
        id: "".concat(this.id, "-WMSLayer"),
        idx: defaultLayerProps.idx,
        serviceType: 'wms',
        data: data.tilesetDataUrl,
        layers: [wmsLayerName],
        opacity: visConfig.opacity,
        transparent: visConfig.transparent,
        pickable: pickable,
        // @ts-ignore
        onClick: pickable ? this._onClick.bind(this, layerCallbacks) : null
      });

      // Store reference to the deck layer for feature info access
      this.deckLayerRef = deckLayer;
      return [deckLayer];
    }
  }, {
    key: "_onClick",
    value: function () {
      var _onClick2 = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee(layerCallbacks, _ref) {
        var bitmap, coordinate, x, y, featureInfo;
        return _regenerator["default"].wrap(function _callee$(_context) {
          while (1) switch (_context.prev = _context.next) {
            case 0:
              bitmap = _ref.bitmap, coordinate = _ref.coordinate;
              if (bitmap) {
                _context.next = 3;
                break;
              }
              return _context.abrupt("return", null);
            case 3:
              x = bitmap.pixel[0];
              y = bitmap.pixel[1];
              _context.next = 7;
              return this.getWMSFeatureInfo(x, y);
            case 7:
              featureInfo = _context.sent;
              // Call the callback to update state with coordinate
              if (layerCallbacks !== null && layerCallbacks !== void 0 && layerCallbacks.onWMSFeatureInfo) {
                layerCallbacks.onWMSFeatureInfo({
                  featureInfo: featureInfo,
                  coordinate: coordinate
                });
              }
              return _context.abrupt("return", featureInfo);
            case 10:
            case "end":
              return _context.stop();
          }
        }, _callee, this);
      }));
      function _onClick(_x, _x2) {
        return _onClick2.apply(this, arguments);
      }
      return _onClick;
    }() // Method to retrieve WMS feature info asynchronously
  }, {
    key: "getWMSFeatureInfo",
    value: function () {
      var _getWMSFeatureInfo = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee2(x, y) {
        var featureInfoXml, parsedAttributes;
        return _regenerator["default"].wrap(function _callee2$(_context2) {
          while (1) switch (_context2.prev = _context2.next) {
            case 0:
              _context2.prev = 0;
              if (!(this.deckLayerRef && typeof this.deckLayerRef.getFeatureInfoText === 'function')) {
                _context2.next = 8;
                break;
              }
              _context2.next = 4;
              return this.deckLayerRef.getFeatureInfoText(x, y);
            case 4:
              featureInfoXml = _context2.sent;
              if (!featureInfoXml) {
                _context2.next = 8;
                break;
              }
              // Parse the XML response to extract attributes
              parsedAttributes = this.parseWMSFeatureInfo(featureInfoXml);
              return _context2.abrupt("return", parsedAttributes.length > 0 ? parsedAttributes : null);
            case 8:
              return _context2.abrupt("return", null);
            case 11:
              _context2.prev = 11;
              _context2.t0 = _context2["catch"](0);
              console.warn('Failed to get WMS feature info:', _context2.t0);
              return _context2.abrupt("return", null);
            case 15:
            case "end":
              return _context2.stop();
          }
        }, _callee2, this, [[0, 11]]);
      }));
      function getWMSFeatureInfo(_x3, _x4) {
        return _getWMSFeatureInfo.apply(this, arguments);
      }
      return getWMSFeatureInfo;
    }() // Helper method to parse WMS XML response
  }, {
    key: "parseWMSFeatureInfo",
    value: function parseWMSFeatureInfo(xmlString) {
      try {
        // Simple XML parsing to extract feature attributes
        var parser = new DOMParser();
        var xmlDoc = parser.parseFromString(xmlString, 'text/xml');
        var attributes = [];

        // Look for feature members
        var featureMembers = xmlDoc.getElementsByTagName('gml:featureMember');
        for (var i = 0; i < featureMembers.length; i++) {
          var featureMember = featureMembers[i];

          // Get all child elements that contain attribute data
          var children = featureMember.children;
          for (var j = 0; j < children.length; j++) {
            var feature = children[j];
            var featureChildren = feature.children;

            // Extract attribute name-value pairs
            for (var k = 0; k < featureChildren.length; k++) {
              var attr = featureChildren[k];
              var tagName = attr.tagName;
              var value = attr.textContent || '';

              // Clean up the tag name (remove namespace prefix)
              var cleanName = tagName.includes(':') ? tagName.split(':')[1] : tagName;

              // Skip empty values and geometry elements
              if (value.trim() && !cleanName.toLowerCase().includes('geom')) {
                attributes.push({
                  name: cleanName.replace(/_/g, ' ').toUpperCase(),
                  value: value.trim()
                });
              }
            }
          }
        }
        return attributes;
      } catch (error) {
        console.warn('Error parsing WMS feature info XML:', error);
        return [];
      }
    }
  }], [{
    key: "findDefaultLayerProps",
    value: function findDefaultLayerProps(dataset) {
      var _dataset$metadata;
      if (dataset.type !== _constants.DatasetType.WMS_TILE) {
        return {
          props: []
        };
      }
      var _ref2 = dataset.metadata || {},
        label = _ref2.label;
      var props = {
        label: label || 'WMS Layer',
        layers: ((_dataset$metadata = dataset.metadata) === null || _dataset$metadata === void 0 ? void 0 : _dataset$metadata.layers) || []
      };
      return {
        props: [props]
      };
    }
  }]);
}(_abstractTileLayer["default"]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY29tbW9uVXRpbHMiLCJyZXF1aXJlIiwiX2NvbnN0YW50cyIsIl9kZWNrZ2xMYXllcnMiLCJfdGlsZURhdGFzZXQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX3dtc0xheWVySWNvbiIsIl9hYnN0cmFjdFRpbGVMYXllciIsIm93bktleXMiLCJlIiwiciIsInQiLCJPYmplY3QiLCJrZXlzIiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwibyIsImZpbHRlciIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJwdXNoIiwiYXBwbHkiLCJfb2JqZWN0U3ByZWFkIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiZm9yRWFjaCIsIl9kZWZpbmVQcm9wZXJ0eTIiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzIiwiZGVmaW5lUHJvcGVydGllcyIsImRlZmluZVByb3BlcnR5IiwiX2NhbGxTdXBlciIsIl9nZXRQcm90b3R5cGVPZjIiLCJfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIiLCJfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0IiwiUmVmbGVjdCIsImNvbnN0cnVjdCIsImNvbnN0cnVjdG9yIiwiQm9vbGVhbiIsInByb3RvdHlwZSIsInZhbHVlT2YiLCJjYWxsIiwiX3N1cGVyUHJvcEdldCIsInAiLCJfZ2V0MiIsIndtc1RpbGVWaXNDb25maWdzIiwiZXhwb3J0cyIsIm9wYWNpdHkiLCJ0cmFuc3BhcmVudCIsIldNU0xheWVyIiwiX0Fic3RyYWN0VGlsZUxheWVyIiwicHJvcHMiLCJfcHJvcHMkbGF5ZXJzJCIsIl9wcm9wcyRsYXllcnMiLCJfdGhpcyIsIl9jbGFzc0NhbGxDaGVjazIiLCJkZWZhdWx0V21zTGF5ZXIiLCJsYXllcnMiLCJyZWdpc3RlclZpc0NvbmZpZyIsInVwZGF0ZUxheWVyVmlzQ29uZmlnIiwid21zTGF5ZXIiLCJfaW5oZXJpdHMyIiwiX2NyZWF0ZUNsYXNzMiIsImtleSIsImdldCIsIkxBWUVSX1RZUEVTIiwid21zIiwiV01TTGF5ZXJJY29uIiwiRGF0YXNldFR5cGUiLCJXTVNfVElMRSIsInZhbHVlIiwiaW5pdFRpbGVEYXRhc2V0IiwiVGlsZURhdGFzZXQiLCJnZXRUaWxlSWQiLCJ0aWxlIiwiaWQiLCJnZXRJdGVyYWJsZSIsIl90aWxlIiwiZ2V0Um93Q291bnQiLCJnZXRSb3dWYWx1ZSIsImFjY2Vzc1Jvd1ZhbHVlIiwiX2ZpZWxkIiwiX2luZGV4S2V5IiwiZm9ybWF0TGF5ZXJEYXRhIiwiZGF0YXNldHMiLCJvbGRMYXllckRhdGEiLCJhbmltYXRpb25Db25maWciLCJkYXRhSWQiLCJjb25maWciLCJub3ROdWxsb3JVbmRlZmluZWQiLCJ0aWxlc2V0RGF0YVVybCIsIm1ldGFkYXRhIiwiZGF0YXNldCIsIl9nZXRDdXJyZW50U2VydmljZUxheWVyIiwiX3Zpc0NvbmZpZyR3bXNMYXllciIsInZpc0NvbmZpZyIsInVwZGF0ZUxheWVyTWV0YSIsInR5cGUiLCJjdXJyZW50TGF5ZXIiLCJib3VuZGluZ0JveCIsInVwZGF0ZU1ldGEiLCJib3VuZHMiLCJoYXNIb3ZlcmVkT2JqZWN0Iiwib2JqZWN0SW5mbyIsImlzTGF5ZXJIb3ZlcmVkIiwiaW5kZXgiLCJnZXRIb3ZlckRhdGEiLCJvYmplY3QiLCJkYXRhQ29udGFpbmVyIiwiZmllbGRzIiwiaG92ZXJJbmZvIiwid21zRmVhdHVyZUluZm8iLCJBcnJheSIsImlzQXJyYXkiLCJ3bXNGZWF0dXJlRGF0YSIsIm5hbWUiLCJ4IiwidW5kZWZpbmVkIiwieSIsImZpZWxkVmFsdWVzIiwibGFiZWxNZXNzYWdlIiwicmVuZGVyTGF5ZXIiLCJvcHRzIiwiX2ludGVyYWN0aW9uQ29uZmlnJHRvIiwiZGF0YSIsImludGVyYWN0aW9uQ29uZmlnIiwibGF5ZXJDYWxsYmFja3MiLCJ3bXNMYXllck5hbWUiLCJxdWVyeWFibGUiLCJkZWZhdWx0TGF5ZXJQcm9wcyIsImdldERlZmF1bHREZWNrTGF5ZXJQcm9wcyIsInBpY2thYmxlIiwidG9vbHRpcCIsImVuYWJsZWQiLCJkZWNrTGF5ZXIiLCJEZWNrV01TTGF5ZXIiLCJjb25jYXQiLCJpZHgiLCJzZXJ2aWNlVHlwZSIsIm9uQ2xpY2siLCJfb25DbGljayIsImJpbmQiLCJkZWNrTGF5ZXJSZWYiLCJfb25DbGljazIiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJfcmVnZW5lcmF0b3IiLCJtYXJrIiwiX2NhbGxlZSIsIl9yZWYiLCJiaXRtYXAiLCJjb29yZGluYXRlIiwiZmVhdHVyZUluZm8iLCJ3cmFwIiwiX2NhbGxlZSQiLCJfY29udGV4dCIsInByZXYiLCJuZXh0IiwiYWJydXB0IiwicGl4ZWwiLCJnZXRXTVNGZWF0dXJlSW5mbyIsInNlbnQiLCJvbldNU0ZlYXR1cmVJbmZvIiwic3RvcCIsIl94IiwiX3gyIiwiX2dldFdNU0ZlYXR1cmVJbmZvIiwiX2NhbGxlZTIiLCJmZWF0dXJlSW5mb1htbCIsInBhcnNlZEF0dHJpYnV0ZXMiLCJfY2FsbGVlMiQiLCJfY29udGV4dDIiLCJnZXRGZWF0dXJlSW5mb1RleHQiLCJwYXJzZVdNU0ZlYXR1cmVJbmZvIiwidDAiLCJjb25zb2xlIiwid2FybiIsIl94MyIsIl94NCIsInhtbFN0cmluZyIsInBhcnNlciIsIkRPTVBhcnNlciIsInhtbERvYyIsInBhcnNlRnJvbVN0cmluZyIsImF0dHJpYnV0ZXMiLCJmZWF0dXJlTWVtYmVycyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiaSIsImZlYXR1cmVNZW1iZXIiLCJjaGlsZHJlbiIsImoiLCJmZWF0dXJlIiwiZmVhdHVyZUNoaWxkcmVuIiwiayIsImF0dHIiLCJ0YWdOYW1lIiwidGV4dENvbnRlbnQiLCJjbGVhbk5hbWUiLCJpbmNsdWRlcyIsInNwbGl0IiwidHJpbSIsInRvTG93ZXJDYXNlIiwicmVwbGFjZSIsInRvVXBwZXJDYXNlIiwiZXJyb3IiLCJmaW5kRGVmYXVsdExheWVyUHJvcHMiLCJfZGF0YXNldCRtZXRhZGF0YSIsIl9yZWYyIiwibGFiZWwiLCJBYnN0cmFjdFRpbGVMYXllciJdLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy93bXMtbGF5ZXIvd21zLWxheWVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVRcbi8vIENvcHlyaWdodCBjb250cmlidXRvcnMgdG8gdGhlIGtlcGxlci5nbCBwcm9qZWN0XG5cbmltcG9ydCB7bm90TnVsbG9yVW5kZWZpbmVkfSBmcm9tICdAa2VwbGVyLmdsL2NvbW1vbi11dGlscyc7XG5pbXBvcnQge0RhdGFzZXRUeXBlLCBXTVNEYXRhc2V0TWV0YWRhdGEsIExBWUVSX1RZUEVTfSBmcm9tICdAa2VwbGVyLmdsL2NvbnN0YW50cyc7XG5pbXBvcnQge1dNU0xheWVyIGFzIERlY2tXTVNMYXllcn0gZnJvbSAnQGtlcGxlci5nbC9kZWNrZ2wtbGF5ZXJzJztcbmltcG9ydCB7S2VwbGVyVGFibGUgYXMgS2VwbGVyRGF0YXNldH0gZnJvbSAnQGtlcGxlci5nbC90YWJsZSc7XG5pbXBvcnQge1xuICBBbmltYXRpb25Db25maWcsXG4gIEZpZWxkLFxuICBMYXllckJhc2VDb25maWcsXG4gIFZpc0NvbmZpZ0Jvb2xlYW4sXG4gIFZpc0NvbmZpZ051bWJlcixcbiAgVmlzQ29uZmlnU2VsZWN0aW9uXG59IGZyb20gJ0BrZXBsZXIuZ2wvdHlwZXMnO1xuaW1wb3J0IHtEYXRhQ29udGFpbmVySW50ZXJmYWNlfSBmcm9tICdAa2VwbGVyLmdsL3V0aWxzJztcblxuaW1wb3J0IFRpbGVEYXRhc2V0IGZyb20gJy4uL3ZlY3Rvci10aWxlL2NvbW1vbi10aWxlL3RpbGUtZGF0YXNldCc7XG5pbXBvcnQgV01TTGF5ZXJJY29uIGZyb20gJy4vd21zLWxheWVyLWljb24nO1xuaW1wb3J0IHtGaW5kRGVmYXVsdExheWVyUHJvcHNSZXR1cm5WYWx1ZX0gZnJvbSAnLi4vbGF5ZXItdXRpbHMnO1xuXG5pbXBvcnQgQWJzdHJhY3RUaWxlTGF5ZXIsIHtcbiAgQWJzdHJhY3RUaWxlTGF5ZXJWaXNDb25maWdTZXR0aW5ncyxcbiAgTGF5ZXJEYXRhXG59IGZyb20gJy4uL3ZlY3Rvci10aWxlL2Fic3RyYWN0LXRpbGUtbGF5ZXInO1xuXG4vLyBUeXBlc1xuZXhwb3J0IHR5cGUgV01TVGlsZSA9IHtcbiAgaWQ6IHN0cmluZztcbiAgdXJsOiBzdHJpbmc7XG59O1xuXG5leHBvcnQgY29uc3Qgd21zVGlsZVZpc0NvbmZpZ3MgPSB7XG4gIG9wYWNpdHk6ICdvcGFjaXR5JyBhcyBjb25zdCxcbiAgdHJhbnNwYXJlbnQ6ICd0cmFuc3BhcmVudCcgYXMgY29uc3Rcbn07XG5cbmV4cG9ydCB0eXBlIFdNU0xheWVyVmlzQ29uZmlnID0ge1xuICBvcGFjaXR5OiBudW1iZXI7XG4gIHRyYW5zcGFyZW50PzogYm9vbGVhbjtcbiAgd21zTGF5ZXI6IHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICBib3VuZGluZ0JveDogbnVtYmVyW11bXTtcbiAgICBxdWVyeWFibGU6IGJvb2xlYW47XG4gIH0gfCBudWxsO1xufTtcblxuZXhwb3J0IHR5cGUgV01TTGF5ZXJDb25maWcgPSBMYXllckJhc2VDb25maWcgJiB7XG4gIHZpc0NvbmZpZzogV01TTGF5ZXJWaXNDb25maWc7XG59O1xuXG4vLyBFeHRlbmQgdmlzQ29uZmlnU2V0dGluZ3MgdG8gc2F0aXNmeSBBYnN0cmFjdFRpbGVMYXllclxuZXhwb3J0IHR5cGUgV01TTGF5ZXJWaXNDb25maWdTZXR0aW5ncyA9IEFic3RyYWN0VGlsZUxheWVyVmlzQ29uZmlnU2V0dGluZ3MgJiB7XG4gIG9wYWNpdHk6IFZpc0NvbmZpZ051bWJlcjtcbiAgdHJhbnNwYXJlbnQ6IFZpc0NvbmZpZ0Jvb2xlYW47XG4gIHdtc0xheWVyOiBWaXNDb25maWdTZWxlY3Rpb247XG59O1xuXG4vLyBFeHRlbmQgTGF5ZXJEYXRhIGZvciBXTVNcbmV4cG9ydCB0eXBlIFdNU0xheWVyRGF0YSA9IExheWVyRGF0YSAmIHtcbiAgdGlsZXNldERhdGFVcmw/OiBzdHJpbmcgfCBudWxsO1xuICBtZXRhZGF0YT86IGFueTtcbn07XG5cbi8vIENsYXNzIERlZmluaXRpb25cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFdNU0xheWVyIGV4dGVuZHMgQWJzdHJhY3RUaWxlTGF5ZXI8V01TVGlsZSwgYW55W10+IHtcbiAgZGVjbGFyZSBjb25maWc6IFdNU0xheWVyQ29uZmlnO1xuICBkZWNsYXJlIHZpc0NvbmZpZ1NldHRpbmdzOiBXTVNMYXllclZpc0NvbmZpZ1NldHRpbmdzO1xuXG4gIC8vIFN0b3JlIHJlZmVyZW5jZSB0byB0aGUgZGVjayBsYXllciBmb3IgZmVhdHVyZSBpbmZvIGFjY2Vzc1xuICBwcml2YXRlIGRlY2tMYXllclJlZjogRGVja1dNU0xheWVyIHwgbnVsbCA9IG51bGw7XG5cbiAgLy8gQ29uc3RydWN0b3JcbiAgY29uc3RydWN0b3IoXG4gICAgcHJvcHM6IENvbnN0cnVjdG9yUGFyYW1ldGVyczx0eXBlb2YgQWJzdHJhY3RUaWxlTGF5ZXI+WzBdICYge1xuICAgICAgbGF5ZXJzPzogV01TRGF0YXNldE1ldGFkYXRhWydsYXllcnMnXTtcbiAgICB9XG4gICkge1xuICAgIHN1cGVyKHByb3BzKTtcblxuICAgIGNvbnN0IGRlZmF1bHRXbXNMYXllciA9IHByb3BzLmxheWVycz8uWzBdID8/IG51bGw7XG5cbiAgICB0aGlzLnJlZ2lzdGVyVmlzQ29uZmlnKHdtc1RpbGVWaXNDb25maWdzKTtcbiAgICB0aGlzLnVwZGF0ZUxheWVyVmlzQ29uZmlnKHtcbiAgICAgIG9wYWNpdHk6IDAuOCwgLy8gRGVmYXVsdCBvcGFjaXR5XG4gICAgICB3bXNMYXllcjogZGVmYXVsdFdtc0xheWVyLFxuICAgICAgdHJhbnNwYXJlbnQ6IHRydWVcbiAgICB9KTtcbiAgfVxuXG4gIC8vIFByb3BlcnRpZXNcbiAgZ2V0IHR5cGUoKSB7XG4gICAgcmV0dXJuIExBWUVSX1RZUEVTLndtcztcbiAgfVxuXG4gIGdldCBuYW1lKCkge1xuICAgIHJldHVybiAnV01TIFRpbGUnO1xuICB9XG5cbiAgZ2V0IGxheWVySWNvbigpIHtcbiAgICByZXR1cm4gV01TTGF5ZXJJY29uO1xuICB9XG5cbiAgLy8gU3RhdGljIE1ldGhvZHNcbiAgc3RhdGljIGZpbmREZWZhdWx0TGF5ZXJQcm9wcyhkYXRhc2V0OiBLZXBsZXJEYXRhc2V0KTogRmluZERlZmF1bHRMYXllclByb3BzUmV0dXJuVmFsdWUge1xuICAgIGlmIChkYXRhc2V0LnR5cGUgIT09IERhdGFzZXRUeXBlLldNU19USUxFKSB7XG4gICAgICByZXR1cm4ge3Byb3BzOiBbXX07XG4gICAgfVxuICAgIGNvbnN0IHtsYWJlbH0gPSBkYXRhc2V0Lm1ldGFkYXRhIHx8IHt9O1xuICAgIGNvbnN0IHByb3BzID0ge1xuICAgICAgbGFiZWw6IGxhYmVsIHx8ICdXTVMgTGF5ZXInLFxuICAgICAgbGF5ZXJzOiBkYXRhc2V0Lm1ldGFkYXRhPy5sYXllcnMgfHwgW11cbiAgICB9O1xuXG4gICAgcmV0dXJuIHtwcm9wczogW3Byb3BzXX07XG4gIH1cblxuICAvLyBJbnN0YW5jZSBNZXRob2RzXG4gIGdldCBzdXBwb3J0ZWREYXRhc2V0VHlwZXMoKTogRGF0YXNldFR5cGVbXSB7XG4gICAgcmV0dXJuIFtEYXRhc2V0VHlwZS5XTVNfVElMRV07XG4gIH1cblxuICBwcm90ZWN0ZWQgaW5pdFRpbGVEYXRhc2V0KCkge1xuICAgIC8vIFByb3ZpZGUgZHVtbXkgYWNjZXNzb3JzIGZvciByYXN0ZXIvV01TXG4gICAgcmV0dXJuIG5ldyBUaWxlRGF0YXNldDxXTVNUaWxlLCBhbnlbXT4oe1xuICAgICAgZ2V0VGlsZUlkOiB0aWxlID0+IHRpbGU/LmlkIHx8ICd3bXMnLFxuICAgICAgZ2V0SXRlcmFibGU6IF90aWxlID0+IFtdLFxuICAgICAgZ2V0Um93Q291bnQ6ICgpID0+IDAsXG4gICAgICBnZXRSb3dWYWx1ZTogKCkgPT4gKCkgPT4gbnVsbFxuICAgIH0pO1xuICB9XG5cbiAgYWNjZXNzUm93VmFsdWUoX2ZpZWxkPzogRmllbGQsIF9pbmRleEtleT86IG51bWJlciB8IG51bGwpIHtcbiAgICAvLyBXTVMgbGF5ZXJzIGFyZSByYXN0ZXIsIHNvIG5vIHJvdyBhY2Nlc3M7IHJldHVybiBhIGR1bW15IGFjY2Vzc29yXG4gICAgcmV0dXJuICgpID0+IG51bGw7XG4gIH1cblxuICBmb3JtYXRMYXllckRhdGEoZGF0YXNldHMsIG9sZExheWVyRGF0YSwgYW5pbWF0aW9uQ29uZmlnKTogV01TTGF5ZXJEYXRhIHtcbiAgICBjb25zdCB7ZGF0YUlkfSA9IHRoaXMuY29uZmlnO1xuICAgIGlmICghbm90TnVsbG9yVW5kZWZpbmVkKGRhdGFJZCkgfHwgIWRhdGFzZXRzW2RhdGFJZF0pIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRpbGVzZXREYXRhVXJsOiBudWxsLFxuICAgICAgICBtZXRhZGF0YTogbnVsbFxuICAgICAgfTtcbiAgICB9XG4gICAgY29uc3QgZGF0YXNldCA9IGRhdGFzZXRzW2RhdGFJZF07XG4gICAgY29uc3QgbWV0YWRhdGEgPSBkYXRhc2V0Py5tZXRhZGF0YTtcblxuICAgIHJldHVybiB7XG4gICAgICAuLi5zdXBlci5mb3JtYXRMYXllckRhdGEoZGF0YXNldHMsIG9sZExheWVyRGF0YSwgYW5pbWF0aW9uQ29uZmlnKSxcbiAgICAgIHRpbGVzZXREYXRhVXJsOiBtZXRhZGF0YT8udGlsZXNldERhdGFVcmwgfHwgbnVsbCwgLy8gVVJMIGZvciBXTVMgdGlsZXNcbiAgICAgIG1ldGFkYXRhOiBkYXRhc2V0Py5tZXRhZGF0YVxuICAgIH07XG4gIH1cblxuICBfZ2V0Q3VycmVudFNlcnZpY2VMYXllcigpIHtcbiAgICBjb25zdCB7dmlzQ29uZmlnfSA9IHRoaXMuY29uZmlnO1xuICAgIHJldHVybiB2aXNDb25maWcud21zTGF5ZXIgPz8gbnVsbDtcbiAgfVxuXG4gIHVwZGF0ZUxheWVyTWV0YShkYXRhc2V0OiBLZXBsZXJEYXRhc2V0KTogdm9pZCB7XG4gICAgaWYgKGRhdGFzZXQudHlwZSAhPT0gRGF0YXNldFR5cGUuV01TX1RJTEUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBjdXJyZW50TGF5ZXIgPSB0aGlzLl9nZXRDdXJyZW50U2VydmljZUxheWVyKCk7XG4gICAgaWYgKGN1cnJlbnRMYXllciAmJiBjdXJyZW50TGF5ZXIuYm91bmRpbmdCb3gpIHtcbiAgICAgIHRoaXMudXBkYXRlTWV0YSh7XG4gICAgICAgIGJvdW5kczogY3VycmVudExheWVyLmJvdW5kaW5nQm94XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBoYXNIb3ZlcmVkT2JqZWN0KG9iamVjdEluZm86IGFueSkge1xuICAgIC8vIEZvciBXTVMgbGF5ZXJzLCB3ZSBjb25zaWRlciBpdCBob3ZlcmVkIGlmIHRoZSBsYXllciBpcyBwaWNrZWRcbiAgICAvLyBUaGUgYWN0dWFsIGZlYXR1cmUgaW5mbyB3aWxsIGJlIHJldHJpZXZlZCB2aWEgZ2V0SG92ZXJEYXRhXG4gICAgaWYgKHRoaXMuaXNMYXllckhvdmVyZWQob2JqZWN0SW5mbykpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGluZGV4OiAwLCAvLyBXTVMgbGF5ZXJzIGRvbid0IGhhdmUgZGlzY3JldGUgZGF0YSBwb2ludHMsIHNvIHdlIHVzZSBpbmRleCAwXG4gICAgICAgIC4uLm9iamVjdEluZm9cbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgZ2V0SG92ZXJEYXRhKFxuICAgIG9iamVjdDogYW55LFxuICAgIGRhdGFDb250YWluZXI6IERhdGFDb250YWluZXJJbnRlcmZhY2UsXG4gICAgZmllbGRzOiBGaWVsZFtdLFxuICAgIGFuaW1hdGlvbkNvbmZpZzogQW5pbWF0aW9uQ29uZmlnLFxuICAgIGhvdmVySW5mbzoge2luZGV4OiBudW1iZXI7IHg/OiBudW1iZXI7IHk/OiBudW1iZXJ9XG4gICkge1xuICAgIC8vIENoZWNrIGlmIHRoaXMgaXMgYSBXTVMgZmVhdHVyZSBpbmZvIG9iamVjdCBmcm9tIGNsaWNrZWQgc3RhdGVcbiAgICBpZiAob2JqZWN0Py53bXNGZWF0dXJlSW5mbykge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkob2JqZWN0Lndtc0ZlYXR1cmVJbmZvKSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHdtc0ZlYXR1cmVEYXRhOiBvYmplY3Qud21zRmVhdHVyZUluZm9cbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgd21zRmVhdHVyZURhdGE6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiAnV01TIEZlYXR1cmUgSW5mbycsXG4gICAgICAgICAgICB2YWx1ZTogb2JqZWN0Lndtc0ZlYXR1cmVJbmZvXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9O1xuICAgIH1cblxuICAgIGlmIChob3ZlckluZm8ueCAhPT0gdW5kZWZpbmVkICYmIGhvdmVySW5mby55ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZpZWxkVmFsdWVzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgbGFiZWxNZXNzYWdlOiAnbGF5ZXIud21zLmhvdmVyJyxcbiAgICAgICAgICAgIHZhbHVlOiAnQ2xpY2sgdG8gcXVlcnkgV01TIGZlYXR1cmUgaW5mbydcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICByZW5kZXJMYXllcihvcHRzKSB7XG4gICAgY29uc3Qge3Zpc0NvbmZpZ30gPSB0aGlzLmNvbmZpZztcbiAgICBjb25zdCB7ZGF0YSwgaW50ZXJhY3Rpb25Db25maWcsIGxheWVyQ2FsbGJhY2tzfSA9IG9wdHM7XG4gICAgY29uc3Qgd21zTGF5ZXIgPSB0aGlzLl9nZXRDdXJyZW50U2VydmljZUxheWVyKCk7XG4gICAgaWYgKCF3bXNMYXllcikge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBjb25zdCB7bmFtZTogd21zTGF5ZXJOYW1lLCBxdWVyeWFibGV9ID0gd21zTGF5ZXI7XG4gICAgY29uc3QgZGVmYXVsdExheWVyUHJvcHMgPSB0aGlzLmdldERlZmF1bHREZWNrTGF5ZXJQcm9wcyhvcHRzKTtcbiAgICBjb25zdCBwaWNrYWJsZSA9IGludGVyYWN0aW9uQ29uZmlnPy50b29sdGlwPy5lbmFibGVkICYmIHF1ZXJ5YWJsZTtcblxuICAgIGNvbnN0IGRlY2tMYXllciA9IG5ldyBEZWNrV01TTGF5ZXIoe1xuICAgICAgaWQ6IGAke3RoaXMuaWR9LVdNU0xheWVyYCBhcyBzdHJpbmcsXG4gICAgICBpZHg6IGRlZmF1bHRMYXllclByb3BzLmlkeCxcbiAgICAgIHNlcnZpY2VUeXBlOiAnd21zJyxcbiAgICAgIGRhdGE6IGRhdGEudGlsZXNldERhdGFVcmwsXG4gICAgICBsYXllcnM6IFt3bXNMYXllck5hbWVdLFxuICAgICAgb3BhY2l0eTogdmlzQ29uZmlnLm9wYWNpdHksXG4gICAgICB0cmFuc3BhcmVudDogdmlzQ29uZmlnLnRyYW5zcGFyZW50LFxuICAgICAgcGlja2FibGUsXG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBvbkNsaWNrOiBwaWNrYWJsZSA/IHRoaXMuX29uQ2xpY2suYmluZCh0aGlzLCBsYXllckNhbGxiYWNrcykgOiBudWxsXG4gICAgfSk7XG5cbiAgICAvLyBTdG9yZSByZWZlcmVuY2UgdG8gdGhlIGRlY2sgbGF5ZXIgZm9yIGZlYXR1cmUgaW5mbyBhY2Nlc3NcbiAgICB0aGlzLmRlY2tMYXllclJlZiA9IGRlY2tMYXllcjtcblxuICAgIHJldHVybiBbZGVja0xheWVyXTtcbiAgfVxuXG4gIHByb3RlY3RlZCBhc3luYyBfb25DbGljayhsYXllckNhbGxiYWNrcywge2JpdG1hcCwgY29vcmRpbmF0ZX0pIHtcbiAgICBpZiAoIWJpdG1hcCkgcmV0dXJuIG51bGw7XG5cbiAgICBjb25zdCB4ID0gYml0bWFwLnBpeGVsWzBdO1xuICAgIGNvbnN0IHkgPSBiaXRtYXAucGl4ZWxbMV07XG4gICAgY29uc3QgZmVhdHVyZUluZm8gPSBhd2FpdCB0aGlzLmdldFdNU0ZlYXR1cmVJbmZvKHgsIHkpO1xuXG4gICAgLy8gQ2FsbCB0aGUgY2FsbGJhY2sgdG8gdXBkYXRlIHN0YXRlIHdpdGggY29vcmRpbmF0ZVxuICAgIGlmIChsYXllckNhbGxiYWNrcz8ub25XTVNGZWF0dXJlSW5mbykge1xuICAgICAgbGF5ZXJDYWxsYmFja3Mub25XTVNGZWF0dXJlSW5mbyh7ZmVhdHVyZUluZm8sIGNvb3JkaW5hdGV9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmVhdHVyZUluZm87XG4gIH1cblxuICAvLyBNZXRob2QgdG8gcmV0cmlldmUgV01TIGZlYXR1cmUgaW5mbyBhc3luY2hyb25vdXNseVxuICBwcm90ZWN0ZWQgYXN5bmMgZ2V0V01TRmVhdHVyZUluZm8oXG4gICAgeDogbnVtYmVyLFxuICAgIHk6IG51bWJlclxuICApOiBQcm9taXNlPEFycmF5PHtuYW1lOiBzdHJpbmc7IHZhbHVlOiBzdHJpbmd9PiB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKHRoaXMuZGVja0xheWVyUmVmICYmIHR5cGVvZiB0aGlzLmRlY2tMYXllclJlZi5nZXRGZWF0dXJlSW5mb1RleHQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY29uc3QgZmVhdHVyZUluZm9YbWwgPSBhd2FpdCB0aGlzLmRlY2tMYXllclJlZi5nZXRGZWF0dXJlSW5mb1RleHQoeCwgeSk7XG4gICAgICAgIGlmIChmZWF0dXJlSW5mb1htbCkge1xuICAgICAgICAgIC8vIFBhcnNlIHRoZSBYTUwgcmVzcG9uc2UgdG8gZXh0cmFjdCBhdHRyaWJ1dGVzXG4gICAgICAgICAgY29uc3QgcGFyc2VkQXR0cmlidXRlcyA9IHRoaXMucGFyc2VXTVNGZWF0dXJlSW5mbyhmZWF0dXJlSW5mb1htbCk7XG4gICAgICAgICAgcmV0dXJuIHBhcnNlZEF0dHJpYnV0ZXMubGVuZ3RoID4gMCA/IHBhcnNlZEF0dHJpYnV0ZXMgOiBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gZ2V0IFdNUyBmZWF0dXJlIGluZm86JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgLy8gSGVscGVyIG1ldGhvZCB0byBwYXJzZSBXTVMgWE1MIHJlc3BvbnNlXG4gIHByb3RlY3RlZCBwYXJzZVdNU0ZlYXR1cmVJbmZvKHhtbFN0cmluZzogc3RyaW5nKTogQXJyYXk8e25hbWU6IHN0cmluZzsgdmFsdWU6IHN0cmluZ30+IHtcbiAgICB0cnkge1xuICAgICAgLy8gU2ltcGxlIFhNTCBwYXJzaW5nIHRvIGV4dHJhY3QgZmVhdHVyZSBhdHRyaWJ1dGVzXG4gICAgICBjb25zdCBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7XG4gICAgICBjb25zdCB4bWxEb2MgPSBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKHhtbFN0cmluZywgJ3RleHQveG1sJyk7XG5cbiAgICAgIGNvbnN0IGF0dHJpYnV0ZXM6IEFycmF5PHtuYW1lOiBzdHJpbmc7IHZhbHVlOiBzdHJpbmd9PiA9IFtdO1xuXG4gICAgICAvLyBMb29rIGZvciBmZWF0dXJlIG1lbWJlcnNcbiAgICAgIGNvbnN0IGZlYXR1cmVNZW1iZXJzID0geG1sRG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdnbWw6ZmVhdHVyZU1lbWJlcicpO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZlYXR1cmVNZW1iZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGZlYXR1cmVNZW1iZXIgPSBmZWF0dXJlTWVtYmVyc1tpXTtcblxuICAgICAgICAvLyBHZXQgYWxsIGNoaWxkIGVsZW1lbnRzIHRoYXQgY29udGFpbiBhdHRyaWJ1dGUgZGF0YVxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IGZlYXR1cmVNZW1iZXIuY2hpbGRyZW47XG5cbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBjaGlsZHJlbi5sZW5ndGg7IGorKykge1xuICAgICAgICAgIGNvbnN0IGZlYXR1cmUgPSBjaGlsZHJlbltqXTtcbiAgICAgICAgICBjb25zdCBmZWF0dXJlQ2hpbGRyZW4gPSBmZWF0dXJlLmNoaWxkcmVuO1xuXG4gICAgICAgICAgLy8gRXh0cmFjdCBhdHRyaWJ1dGUgbmFtZS12YWx1ZSBwYWlyc1xuICAgICAgICAgIGZvciAobGV0IGsgPSAwOyBrIDwgZmVhdHVyZUNoaWxkcmVuLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICBjb25zdCBhdHRyID0gZmVhdHVyZUNoaWxkcmVuW2tdO1xuICAgICAgICAgICAgY29uc3QgdGFnTmFtZSA9IGF0dHIudGFnTmFtZTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYXR0ci50ZXh0Q29udGVudCB8fCAnJztcblxuICAgICAgICAgICAgLy8gQ2xlYW4gdXAgdGhlIHRhZyBuYW1lIChyZW1vdmUgbmFtZXNwYWNlIHByZWZpeClcbiAgICAgICAgICAgIGNvbnN0IGNsZWFuTmFtZSA9IHRhZ05hbWUuaW5jbHVkZXMoJzonKSA/IHRhZ05hbWUuc3BsaXQoJzonKVsxXSA6IHRhZ05hbWU7XG5cbiAgICAgICAgICAgIC8vIFNraXAgZW1wdHkgdmFsdWVzIGFuZCBnZW9tZXRyeSBlbGVtZW50c1xuICAgICAgICAgICAgaWYgKHZhbHVlLnRyaW0oKSAmJiAhY2xlYW5OYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2dlb20nKSkge1xuICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnB1c2goe1xuICAgICAgICAgICAgICAgIG5hbWU6IGNsZWFuTmFtZS5yZXBsYWNlKC9fL2csICcgJykudG9VcHBlckNhc2UoKSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWUudHJpbSgpXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gYXR0cmlidXRlcztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdFcnJvciBwYXJzaW5nIFdNUyBmZWF0dXJlIGluZm8gWE1MOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4g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