// loaders.gl
// SPDX-License-Identifier: MIT
// Copyright (c) vis.gl contributors
import { convertParquetSchema } from "../arrow/convert-schema-from-parquet.js";
import { unpackGeoMetadata, unpackJSONStringMetadata } from '@loaders.gl/gis';
export async function getSchemaFromParquetReader(reader) {
    const parquetSchema = await reader.getSchema();
    const parquetMetadata = await reader.getFileMetadata();
    const schema = convertParquetSchema(parquetSchema, parquetMetadata);
    unpackGeoMetadata(schema);
    unpackJSONStringMetadata(schema, 'pandas');
    return schema;
}
